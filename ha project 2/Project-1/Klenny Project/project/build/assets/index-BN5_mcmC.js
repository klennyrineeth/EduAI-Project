import{j as e,m as t}from"./animation-vendor-CAYDsUAS.js";import{b as s,a as n,u as r,L as o,B as i,R as a,c as l}from"./react-vendor-CJEVgDU_.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var c,d={};var u=function(){if(c)return d;c=1;var e=s();return d.createRoot=e.createRoot,d.hydrateRoot=e.hydrateRoot,d}(),h={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const p=(e,t)=>{const s=n.forwardRef((({color:s="currentColor",size:r=24,strokeWidth:o=2,absoluteStrokeWidth:i,className:a="",children:l,...c},d)=>{return n.createElement("svg",{ref:d,...h,width:r,height:r,stroke:s,strokeWidth:i?24*Number(o)/Number(r):o,className:["lucide",`lucide-${u=e,u.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()}`,a].join(" "),...c},[...t.map((([e,t])=>n.createElement(e,t))),...Array.isArray(l)?l:[l]]);var u}));return s.displayName=`${e}`,s},f=p("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]),m=p("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),g=p("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),y=p("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),w=p("Cpu",[["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"9",y:"9",width:"6",height:"6",key:"o3kz5p"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]),v=p("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),x=p("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),b=p("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),_=p("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]),E=p("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),C=p("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),j=p("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),A=p("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),N=p("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),S=p("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),I=p("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),O=p("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),R=p("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]),k=p("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),T=p("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),P=p("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),$=p("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),M=p("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function L(){const[t,s]=n.useState(!1),i=r(),a=[{path:"/",label:"Home"},{path:"/how-it-works",label:"How It Works"},{path:"/features",label:"Features"},{path:"/live-demo",label:"Live Demo"},{path:"/about",label:"About"},{path:"/contact",label:"Contact"}];return e.jsx("nav",{className:"bg-white shadow-lg",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex justify-between h-16",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs(o,{to:"/",className:"flex items-center space-x-2",children:[e.jsx(w,{className:"h-8 w-8 text-purple-600"}),e.jsx("span",{className:"text-xl font-bold text-gray-900",children:"EduAI"})]})}),e.jsx("div",{className:"hidden md:flex items-center space-x-8",children:a.map((t=>e.jsx(o,{to:t.path,className:(i.pathname===t.path?"text-purple-600 border-b-2 border-purple-600":"text-gray-600 hover:text-purple-600")+" px-3 py-2 text-sm font-medium transition-colors",children:t.label},t.path)))}),e.jsx("div",{className:"md:hidden flex items-center",children:e.jsx("button",{onClick:()=>s(!t),className:"text-gray-600 hover:text-purple-600 focus:outline-none",children:t?e.jsx($,{className:"h-6 w-6"}):e.jsx(A,{className:"h-6 w-6"})})})]}),t&&e.jsx("div",{className:"md:hidden",children:e.jsx("div",{className:"pt-2 pb-3 space-y-1",children:a.map((t=>e.jsx(o,{to:t.path,className:(i.pathname===t.path?"bg-purple-50 text-purple-600":"text-gray-600 hover:bg-purple-50 hover:text-purple-600")+" block px-3 py-2 rounded-md text-base font-medium",onClick:()=>s(!1),children:t.label},t.path)))})})]})})}function D(){return e.jsx("footer",{className:"bg-gray-900 text-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"About EduAI"}),e.jsx("p",{className:"text-gray-400",children:"Transforming traditional education with AI-powered digital boards and interactive learning experiences."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Quick Links"}),e.jsxs("ul",{className:"space-y-2",children:[e.jsx("li",{children:e.jsx(o,{to:"/how-it-works",className:"text-gray-400 hover:text-white",children:"How It Works"})}),e.jsx("li",{children:e.jsx(o,{to:"/features",className:"text-gray-400 hover:text-white",children:"Features"})}),e.jsx("li",{children:e.jsx(o,{to:"/live-demo",className:"text-gray-400 hover:text-white",children:"Live Demo"})}),e.jsx("li",{children:e.jsx(o,{to:"/about",className:"text-gray-400 hover:text-white",children:"About Us"})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Contact"}),e.jsxs("ul",{className:"space-y-2",children:[e.jsx("li",{className:"text-gray-400",children:"Email: info@eduai.com"}),e.jsx("li",{className:"text-gray-400",children:"Phone: (555) 123-4567"}),e.jsx("li",{className:"text-gray-400",children:"Address: 123 Education St, Tech City"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Follow Us"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:e.jsx(v,{className:"h-6 w-6"})}),e.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:e.jsx(R,{className:"h-6 w-6"})}),e.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:e.jsx(_,{className:"h-6 w-6"})}),e.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:e.jsx(C,{className:"h-6 w-6"})})]})]})]}),e.jsx("div",{className:"mt-8 pt-8 border-t border-gray-800 text-center text-gray-400",children:e.jsxs("p",{children:["© ",(new Date).getFullYear()," EduAI. All rights reserved."]})})]})})}function F(){return e.jsxs("div",{className:"relative min-h-screen flex flex-col",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 flex-1",children:[e.jsxs(t.div,{initial:{x:-100,opacity:0},animate:{x:0,opacity:1},transition:{duration:.8},className:"relative bg-gray-900 flex items-center justify-center p-8",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('https://images.unsplash.com/photo-1532619675605-1ede6c2ed2b0?auto=format&fit=crop&q=80')] bg-cover bg-center opacity-20"}),e.jsxs("div",{className:"relative text-white text-center",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Traditional Teaching"}),e.jsx("p",{className:"text-gray-300",children:"Static content limited by physical constraints"})]})]}),e.jsxs(t.div,{initial:{x:100,opacity:0},animate:{x:0,opacity:1},transition:{duration:.8},className:"relative bg-gradient-to-br from-purple-600 to-indigo-700 flex items-center justify-center p-8",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('https://images.unsplash.com/photo-1488190211105-8b0e65b80b4e?auto=format&fit=crop&q=80')] bg-cover bg-center opacity-10"}),e.jsxs("div",{className:"relative text-white text-center",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"AI-Powered Learning"}),e.jsx("p",{className:"text-gray-100",children:"Interactive content that adapts to student needs"})]})]})]}),e.jsx(t.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{duration:.8,delay:.4},className:"bg-white py-16",children:e.jsxs("div",{className:"max-w-2xl mx-auto text-center px-4",children:[e.jsx("h1",{className:"text-4xl md:text-6xl font-bold text-gray-900 mb-6",children:"Transform Your Teaching"}),e.jsx("p",{className:"text-xl text-gray-600 mb-8",children:"Experience the future of education with AI-powered digital boards"}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsxs(o,{to:"/live-demo",className:"bg-purple-600 text-white px-8 py-3 rounded-full font-semibold flex items-center gap-2 hover:bg-purple-700 transition-colors",children:["Try Demo ",e.jsx(N,{size:16})]}),e.jsxs(o,{to:"/how-it-works",className:"border border-purple-600 text-purple-600 px-8 py-3 rounded-full font-semibold flex items-center gap-2 hover:bg-purple-50 transition-colors",children:["Learn More ",e.jsx(g,{size:16})]})]})]})})]})}const q=[{icon:k,title:"Upload Content",description:"Submit your educational materials and curriculum requirements"},{icon:w,title:"AI Processing",description:"Our AI analyzes and transforms content into engaging video lessons"},{icon:P,title:"Image & Video Generation",description:"High-quality educational images and videos are created automatically"},{icon:m,title:"Ready to Use",description:"Download or stream your AI-generated educational content"}];function U(){return e.jsx("div",{className:"py-24 bg-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs(t.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.6},className:"text-center mb-16",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"How It Works"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Simple steps to transform your educational content"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:q.map(((s,n)=>e.jsxs(t.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.6,delay:.2*n},children:[e.jsx("div",{className:"relative",children:e.jsx(s.icon,{className:"w-16 h-16 text-purple-600 mx-auto mb-4"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:s.title}),e.jsx("p",{className:"text-gray-600",children:s.description})]},n)))})]})})}const B=[{icon:f,title:"AI-Powered Content Generation",description:"Advanced algorithms create engaging educational videos tailored to your curriculum"},{icon:x,title:"Multilingual Support",description:"Automatically translate content into multiple languages for global accessibility"},{icon:M,title:"Real-time Adaptability",description:"Content adjusts based on student performance and learning patterns"},{icon:y,title:"Time-Saving",description:"Generate hours of quality content in minutes, not days"},{icon:T,title:"Collaborative Learning",description:"Foster engagement through interactive video experiences"},{icon:O,title:"Quality Assured",description:"AI-generated content reviewed for educational standards compliance"}];function H(){return e.jsx("div",{className:"py-24 bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Powerful Features for Modern Education"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Discover how our AI technology revolutionizes educational content creation"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:B.map(((t,s)=>e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(t.icon,{className:"w-12 h-12 text-purple-600 mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:t.title}),e.jsx("p",{className:"text-gray-600",children:t.description})]},s)))})]})})}var W,z,G,K,V,X;(z=W||(W={})).STRING="string",z.NUMBER="number",z.INTEGER="integer",z.BOOLEAN="boolean",z.ARRAY="array",z.OBJECT="object",(K=G||(G={})).LANGUAGE_UNSPECIFIED="language_unspecified",K.PYTHON="python",(X=V||(V={})).OUTCOME_UNSPECIFIED="outcome_unspecified",X.OUTCOME_OK="outcome_ok",X.OUTCOME_FAILED="outcome_failed",X.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded";
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const J=["user","model","function","system"];var Y,Q,Z,ee,te,se,ne,re,oe,ie,ae,le,ce,de,ue,he;(Q=Y||(Y={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",Q.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",Q.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",Q.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",Q.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",Q.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",(ee=Z||(Z={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",ee.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",ee.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",ee.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",ee.BLOCK_NONE="BLOCK_NONE",(se=te||(te={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",se.NEGLIGIBLE="NEGLIGIBLE",se.LOW="LOW",se.MEDIUM="MEDIUM",se.HIGH="HIGH",(re=ne||(ne={})).BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",re.SAFETY="SAFETY",re.OTHER="OTHER",(ie=oe||(oe={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",ie.STOP="STOP",ie.MAX_TOKENS="MAX_TOKENS",ie.SAFETY="SAFETY",ie.RECITATION="RECITATION",ie.LANGUAGE="LANGUAGE",ie.BLOCKLIST="BLOCKLIST",ie.PROHIBITED_CONTENT="PROHIBITED_CONTENT",ie.SPII="SPII",ie.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",ie.OTHER="OTHER",(le=ae||(ae={})).TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",le.RETRIEVAL_QUERY="RETRIEVAL_QUERY",le.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",le.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",le.CLASSIFICATION="CLASSIFICATION",le.CLUSTERING="CLUSTERING",(de=ce||(ce={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",de.AUTO="AUTO",de.ANY="ANY",de.NONE="NONE",(he=ue||(ue={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",he.MODE_DYNAMIC="MODE_DYNAMIC";
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class pe extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class fe extends pe{constructor(e,t){super(e),this.response=t}}class me extends pe{constructor(e,t,s,n){super(e),this.status=t,this.statusText=s,this.errorDetails=n}}class ge extends pe{}class ye extends pe{}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var we,ve;(ve=we||(we={})).GENERATE_CONTENT="generateContent",ve.STREAM_GENERATE_CONTENT="streamGenerateContent",ve.COUNT_TOKENS="countTokens",ve.EMBED_CONTENT="embedContent",ve.BATCH_EMBED_CONTENTS="batchEmbedContents";class xe{constructor(e,t,s,n,r){this.model=e,this.task=t,this.apiKey=s,this.stream=n,this.requestOptions=r}toString(){var e,t;const s=(null===(e=this.requestOptions)||void 0===e?void 0:e.apiVersion)||"v1beta";let n=`${(null===(t=this.requestOptions)||void 0===t?void 0:t.baseUrl)||"https://generativelanguage.googleapis.com"}/${s}/${this.model}:${this.task}`;return this.stream&&(n+="?alt=sse"),n}}async function be(e){var t;const s=new Headers;s.append("Content-Type","application/json"),s.append("x-goog-api-client",function(e){const t=[];return(null==e?void 0:e.apiClient)&&t.push(e.apiClient),t.push("genai-js/0.24.0"),t.join(" ")}(e.requestOptions)),s.append("x-goog-api-key",e.apiKey);let n=null===(t=e.requestOptions)||void 0===t?void 0:t.customHeaders;if(n){if(!(n instanceof Headers))try{n=new Headers(n)}catch(r){throw new ge(`unable to convert customHeaders value ${JSON.stringify(n)} to Headers: ${r.message}`)}for(const[e,t]of n.entries()){if("x-goog-api-key"===e)throw new ge(`Cannot set reserved header name ${e}`);if("x-goog-api-client"===e)throw new ge(`Header name ${e} can only be set using the apiClient field`);s.append(e,t)}}return s}async function _e(e,t,s,n,r,o={},i=fetch){const{url:a,fetchOptions:l}=await async function(e,t,s,n,r,o){const i=new xe(e,t,s,n,o);return{url:i.toString(),fetchOptions:Object.assign(Object.assign({},Ee(o)),{method:"POST",headers:await be(i),body:r})}}(e,t,s,n,r,o);return async function(e,t,s=fetch){let n;try{n=await s(e,t)}catch(r){!function(e,t){let s=e;"AbortError"===s.name?(s=new ye(`Request aborted when fetching ${t.toString()}: ${e.message}`),s.stack=e.stack):e instanceof me||e instanceof ge||(s=new pe(`Error fetching from ${t.toString()}: ${e.message}`),s.stack=e.stack);throw s}(r,e)}n.ok||await async function(e,t){let s,n="";try{const t=await e.json();n=t.error.message,t.error.details&&(n+=` ${JSON.stringify(t.error.details)}`,s=t.error.details)}catch(r){}throw new me(`Error fetching from ${t.toString()}: [${e.status} ${e.statusText}] ${n}`,e.status,e.statusText,s)}(n,e);return n}(a,l,i)}function Ee(e){const t={};if(void 0!==(null==e?void 0:e.signal)||(null==e?void 0:e.timeout)>=0){const s=new AbortController;(null==e?void 0:e.timeout)>=0&&setTimeout((()=>s.abort()),e.timeout),(null==e?void 0:e.signal)&&e.signal.addEventListener("abort",(()=>{s.abort()})),t.signal=s.signal}return t}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ce(e){return e.text=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),Ne(e.candidates[0]))throw new fe(`${Se(e)}`,e);return function(e){var t,s,n,r;const o=[];if(null===(s=null===(t=e.candidates)||void 0===t?void 0:t[0].content)||void 0===s?void 0:s.parts)for(const i of null===(r=null===(n=e.candidates)||void 0===n?void 0:n[0].content)||void 0===r?void 0:r.parts)i.text&&o.push(i.text),i.executableCode&&o.push("\n```"+i.executableCode.language+"\n"+i.executableCode.code+"\n```\n"),i.codeExecutionResult&&o.push("\n```\n"+i.codeExecutionResult.output+"\n```\n");return o.length>0?o.join(""):""}(e)}if(e.promptFeedback)throw new fe(`Text not available. ${Se(e)}`,e);return""},e.functionCall=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Ne(e.candidates[0]))throw new fe(`${Se(e)}`,e);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),je(e)[0]}if(e.promptFeedback)throw new fe(`Function call not available. ${Se(e)}`,e)},e.functionCalls=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Ne(e.candidates[0]))throw new fe(`${Se(e)}`,e);return je(e)}if(e.promptFeedback)throw new fe(`Function call not available. ${Se(e)}`,e)},e}function je(e){var t,s,n,r;const o=[];if(null===(s=null===(t=e.candidates)||void 0===t?void 0:t[0].content)||void 0===s?void 0:s.parts)for(const i of null===(r=null===(n=e.candidates)||void 0===n?void 0:n[0].content)||void 0===r?void 0:r.parts)i.functionCall&&o.push(i.functionCall);return o.length>0?o:void 0}const Ae=[oe.RECITATION,oe.SAFETY,oe.LANGUAGE];function Ne(e){return!!e.finishReason&&Ae.includes(e.finishReason)}function Se(e){var t,s,n;let r="";if(e.candidates&&0!==e.candidates.length||!e.promptFeedback){if(null===(n=e.candidates)||void 0===n?void 0:n[0]){const t=e.candidates[0];Ne(t)&&(r+=`Candidate was blocked due to ${t.finishReason}`,t.finishMessage&&(r+=`: ${t.finishMessage}`))}}else r+="Response was blocked",(null===(t=e.promptFeedback)||void 0===t?void 0:t.blockReason)&&(r+=` due to ${e.promptFeedback.blockReason}`),(null===(s=e.promptFeedback)||void 0===s?void 0:s.blockReasonMessage)&&(r+=`: ${e.promptFeedback.blockReasonMessage}`);return r}function Ie(e){return this instanceof Ie?(this.v=e,this):new Ie(e)}function Oe(e,t,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,r=s.apply(e,t||[]),o=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){r[e]&&(n[e]=function(t){return new Promise((function(s,n){o.push([e,t,s,n])>1||a(e,t)}))})}function a(e,t){try{(s=r[e](t)).value instanceof Ie?Promise.resolve(s.value.v).then(l,c):d(o[0][2],s)}catch(n){d(o[0][3],n)}var s}function l(e){a("next",e)}function c(e){a("throw",e)}function d(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}"function"==typeof SuppressedError&&SuppressedError;
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Re=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function ke(e){const t=function(e){const t=e.getReader();return new ReadableStream({start(e){let s="";return n();function n(){return t.read().then((({value:t,done:r})=>{if(r)return s.trim()?void e.error(new pe("Failed to parse stream")):void e.close();s+=t;let o,i=s.match(Re);for(;i;){try{o=JSON.parse(i[1])}catch(a){return void e.error(new pe(`Error parsing JSON response: "${i[1]}"`))}e.enqueue(o),s=s.substring(i[0].length),i=s.match(Re)}return n()})).catch((e=>{let t=e;throw t.stack=e.stack,t="AbortError"===t.name?new ye("Request aborted when reading from the stream"):new pe("Error reading from the stream"),t}))}}})}(e.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0}))),[s,n]=t.tee();return{stream:Pe(s),response:Te(n)}}async function Te(e){const t=[],s=e.getReader();for(;;){const{done:e,value:n}=await s.read();if(e)return Ce($e(t));t.push(n)}}function Pe(e){return Oe(this,arguments,(function*(){const t=e.getReader();for(;;){const{value:e,done:s}=yield Ie(t.read());if(s)break;yield yield Ie(Ce(e))}}))}function $e(e){const t=e[e.length-1],s={promptFeedback:null==t?void 0:t.promptFeedback};for(const n of e){if(n.candidates){let e=0;for(const t of n.candidates)if(s.candidates||(s.candidates=[]),s.candidates[e]||(s.candidates[e]={index:e}),s.candidates[e].citationMetadata=t.citationMetadata,s.candidates[e].groundingMetadata=t.groundingMetadata,s.candidates[e].finishReason=t.finishReason,s.candidates[e].finishMessage=t.finishMessage,s.candidates[e].safetyRatings=t.safetyRatings,t.content&&t.content.parts){s.candidates[e].content||(s.candidates[e].content={role:t.content.role||"user",parts:[]});const n={};for(const r of t.content.parts)r.text&&(n.text=r.text),r.functionCall&&(n.functionCall=r.functionCall),r.executableCode&&(n.executableCode=r.executableCode),r.codeExecutionResult&&(n.codeExecutionResult=r.codeExecutionResult),0===Object.keys(n).length&&(n.text=""),s.candidates[e].content.parts.push(n)}e++}n.usageMetadata&&(s.usageMetadata=n.usageMetadata)}return s}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Me(e,t,s,n){return ke(await _e(t,we.STREAM_GENERATE_CONTENT,e,!0,JSON.stringify(s),n))}async function Le(e,t,s,n){const r=await _e(t,we.GENERATE_CONTENT,e,!1,JSON.stringify(s),n);return{response:Ce(await r.json())}}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function De(e){if(null!=e)return"string"==typeof e?{role:"system",parts:[{text:e}]}:e.text?{role:"system",parts:[e]}:e.parts?e.role?e:{role:"system",parts:e.parts}:void 0}function Fe(e){let t=[];if("string"==typeof e)t=[{text:e}];else for(const s of e)"string"==typeof s?t.push({text:s}):t.push(s);return function(e){const t={role:"user",parts:[]},s={role:"function",parts:[]};let n=!1,r=!1;for(const o of e)"functionResponse"in o?(s.parts.push(o),r=!0):(t.parts.push(o),n=!0);if(n&&r)throw new pe("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!n&&!r)throw new pe("No content is provided for sending chat message.");if(n)return t;return s}(t)}function qe(e){let t;if(e.contents)t=e;else{t={contents:[Fe(e)]}}return e.systemInstruction&&(t.systemInstruction=De(e.systemInstruction)),t}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Ue=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],Be={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function He(e){var t;if(void 0===e.candidates||0===e.candidates.length)return!1;const s=null===(t=e.candidates[0])||void 0===t?void 0:t.content;if(void 0===s)return!1;if(void 0===s.parts||0===s.parts.length)return!1;for(const n of s.parts){if(void 0===n||0===Object.keys(n).length)return!1;if(void 0!==n.text&&""===n.text)return!1}return!0}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const We="SILENT_ERROR";class ze{constructor(e,t,s,n={}){this.model=t,this.params=s,this._requestOptions=n,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,(null==s?void 0:s.history)&&(!function(e){let t=!1;for(const s of e){const{role:e,parts:n}=s;if(!t&&"user"!==e)throw new pe(`First content should be with role 'user', got ${e}`);if(!J.includes(e))throw new pe(`Each item should include role field. Got ${e} but valid roles are: ${JSON.stringify(J)}`);if(!Array.isArray(n))throw new pe("Content should have 'parts' property with an array of Parts");if(0===n.length)throw new pe("Each Content should have at least one part");const r={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const t of n)for(const e of Ue)e in t&&(r[e]+=1);const o=Be[e];for(const t of Ue)if(!o.includes(t)&&r[t]>0)throw new pe(`Content with role '${e}' can't contain '${t}' part`);t=!0}}(s.history),this._history=s.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,t={}){var s,n,r,o,i,a;await this._sendPromise;const l=Fe(e),c={safetySettings:null===(s=this.params)||void 0===s?void 0:s.safetySettings,generationConfig:null===(n=this.params)||void 0===n?void 0:n.generationConfig,tools:null===(r=this.params)||void 0===r?void 0:r.tools,toolConfig:null===(o=this.params)||void 0===o?void 0:o.toolConfig,systemInstruction:null===(i=this.params)||void 0===i?void 0:i.systemInstruction,cachedContent:null===(a=this.params)||void 0===a?void 0:a.cachedContent,contents:[...this._history,l]},d=Object.assign(Object.assign({},this._requestOptions),t);let u;return this._sendPromise=this._sendPromise.then((()=>Le(this._apiKey,this.model,c,d))).then((e=>{var t;if(He(e.response)){this._history.push(l);const s=Object.assign({parts:[],role:"model"},null===(t=e.response.candidates)||void 0===t?void 0:t[0].content);this._history.push(s)}else{const t=Se(e.response);t&&console.warn(`sendMessage() was unsuccessful. ${t}. Inspect response object for details.`)}u=e})),await this._sendPromise,u}async sendMessageStream(e,t={}){var s,n,r,o,i,a;await this._sendPromise;const l=Fe(e),c={safetySettings:null===(s=this.params)||void 0===s?void 0:s.safetySettings,generationConfig:null===(n=this.params)||void 0===n?void 0:n.generationConfig,tools:null===(r=this.params)||void 0===r?void 0:r.tools,toolConfig:null===(o=this.params)||void 0===o?void 0:o.toolConfig,systemInstruction:null===(i=this.params)||void 0===i?void 0:i.systemInstruction,cachedContent:null===(a=this.params)||void 0===a?void 0:a.cachedContent,contents:[...this._history,l]},d=Object.assign(Object.assign({},this._requestOptions),t),u=Me(this._apiKey,this.model,c,d);return this._sendPromise=this._sendPromise.then((()=>u)).catch((e=>{throw new Error(We)})).then((e=>e.response)).then((e=>{if(He(e)){this._history.push(l);const t=Object.assign({},e.candidates[0].content);t.role||(t.role="model"),this._history.push(t)}else{const t=Se(e);t&&console.warn(`sendMessageStream() was unsuccessful. ${t}. Inspect response object for details.`)}})).catch((e=>{e.message!==We&&console.error(e)})),u}}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ge{constructor(e,t,s={}){this.apiKey=e,this._requestOptions=s,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.toolConfig=t.toolConfig,this.systemInstruction=De(t.systemInstruction),this.cachedContent=t.cachedContent}async generateContent(e,t={}){var s;const n=qe(e),r=Object.assign(Object.assign({},this._requestOptions),t);return Le(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null===(s=this.cachedContent)||void 0===s?void 0:s.name},n),r)}async generateContentStream(e,t={}){var s;const n=qe(e),r=Object.assign(Object.assign({},this._requestOptions),t);return Me(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null===(s=this.cachedContent)||void 0===s?void 0:s.name},n),r)}startChat(e){var t;return new ze(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null===(t=this.cachedContent)||void 0===t?void 0:t.name},e),this._requestOptions)}async countTokens(e,t={}){const s=function(e,t){var s;let n={model:null==t?void 0:t.model,generationConfig:null==t?void 0:t.generationConfig,safetySettings:null==t?void 0:t.safetySettings,tools:null==t?void 0:t.tools,toolConfig:null==t?void 0:t.toolConfig,systemInstruction:null==t?void 0:t.systemInstruction,cachedContent:null===(s=null==t?void 0:t.cachedContent)||void 0===s?void 0:s.name,contents:[]};const r=null!=e.generateContentRequest;if(e.contents){if(r)throw new ge("CountTokensRequest must have one of contents or generateContentRequest, not both.");n.contents=e.contents}else if(r)n=Object.assign(Object.assign({},n),e.generateContentRequest);else{const t=Fe(e);n.contents=[t]}return{generateContentRequest:n}}(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),n=Object.assign(Object.assign({},this._requestOptions),t);return async function(e,t,s,n){return(await _e(t,we.COUNT_TOKENS,e,!1,JSON.stringify(s),n)).json()}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(this.apiKey,this.model,s,n)}async embedContent(e,t={}){const s=function(e){if("string"==typeof e||Array.isArray(e))return{content:Fe(e)};return e}(e),n=Object.assign(Object.assign({},this._requestOptions),t);return async function(e,t,s,n){return(await _e(t,we.EMBED_CONTENT,e,!1,JSON.stringify(s),n)).json()}(this.apiKey,this.model,s,n)}async batchEmbedContents(e,t={}){const s=Object.assign(Object.assign({},this._requestOptions),t);return async function(e,t,s,n){const r=s.requests.map((e=>Object.assign(Object.assign({},e),{model:t})));return(await _e(t,we.BATCH_EMBED_CONTENTS,e,!1,JSON.stringify({requests:r}),n)).json()}(this.apiKey,this.model,e,s)}}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ke="RFC3986",Ve={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)},Xe=Array.isArray,Je=(()=>{const e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})(),Ye=1024;function Qe(e,t){if(Xe(e)){const s=[];for(let n=0;n<e.length;n+=1)s.push(t(e[n]));return s}return t(e)}const Ze=Object.prototype.hasOwnProperty,et={brackets:e=>String(e)+"[]",comma:"comma",indices:(e,t)=>String(e)+"["+t+"]",repeat:e=>String(e)},tt=Array.isArray,st=Array.prototype.push,nt=function(e,t){st.apply(e,tt(t)?t:[t])},rt=Date.prototype.toISOString,ot={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:(e,t,s,n,r)=>{if(0===e.length)return e;let o=e;if("symbol"==typeof e?o=Symbol.prototype.toString.call(e):"string"!=typeof e&&(o=String(e)),"iso-8859-1"===s)return escape(o).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));let i="";for(let a=0;a<o.length;a+=Ye){const e=o.length>=Ye?o.slice(a,a+Ye):o,t=[];for(let s=0;s<e.length;++s){let n=e.charCodeAt(s);45===n||46===n||95===n||126===n||n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122||"RFC1738"===r&&(40===n||41===n)?t[t.length]=e.charAt(s):n<128?t[t.length]=Je[n]:n<2048?t[t.length]=Je[192|n>>6]+Je[128|63&n]:n<55296||n>=57344?t[t.length]=Je[224|n>>12]+Je[128|n>>6&63]+Je[128|63&n]:(s+=1,n=65536+((1023&n)<<10|1023&e.charCodeAt(s)),t[t.length]=Je[240|n>>18]+Je[128|n>>12&63]+Je[128|n>>6&63]+Je[128|63&n])}i+=t.join("")}return i},encodeValuesOnly:!1,format:Ke,formatter:Ve[Ke],indices:!1,serializeDate:e=>rt.call(e),skipNulls:!1,strictNullHandling:!1};const it={};function at(e,t,s,n,r,o,i,a,l,c,d,u,h,p,f,m,g,y){let w=e,v=y,x=0,b=!1;for(;void 0!==(v=v.get(it))&&!b;){const t=v.get(e);if(x+=1,void 0!==t){if(t===x)throw new RangeError("Cyclic object value");b=!0}void 0===v.get(it)&&(x=0)}if("function"==typeof c?w=c(t,w):w instanceof Date?w=null==h?void 0:h(w):"comma"===s&&tt(w)&&(w=Qe(w,(function(e){return e instanceof Date?null==h?void 0:h(e):e}))),null===w){if(o)return l&&!m?l(t,ot.encoder,g,"key",p):t;w=""}if("string"==typeof(_=w)||"number"==typeof _||"boolean"==typeof _||"symbol"==typeof _||"bigint"==typeof _||function(e){return!(!e||"object"!=typeof e||!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e)))}(w)){if(l){const e=m?t:l(t,ot.encoder,g,"key",p);return[(null==f?void 0:f(e))+"="+(null==f?void 0:f(l(w,ot.encoder,g,"value",p)))]}return[(null==f?void 0:f(t))+"="+(null==f?void 0:f(String(w)))]}var _;const E=[];if(void 0===w)return E;let C;if("comma"===s&&tt(w))m&&l&&(w=Qe(w,l)),C=[{value:w.length>0?w.join(",")||null:void 0}];else if(tt(c))C=c;else{const e=Object.keys(w);C=d?e.sort(d):e}const j=a?String(t).replace(/\./g,"%2E"):String(t),A=n&&tt(w)&&1===w.length?j+"[]":j;if(r&&tt(w)&&0===w.length)return A+"[]";for(let N=0;N<C.length;++N){const t=C[N],v="object"==typeof t&&void 0!==t.value?t.value:w[t];if(i&&null===v)continue;const b=u&&a?t.replace(/\./g,"%2E"):t,_=tt(w)?"function"==typeof s?s(A,b):A:A+(u?"."+b:"["+b+"]");y.set(e,x);const j=new WeakMap;j.set(it,y),nt(E,at(v,_,s,n,r,o,i,a,"comma"===s&&m&&tt(w)?null:l,c,d,u,h,p,f,m,g,j))}return E}function lt(e,t={}){let s=e;const n=function(e=ot){if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.encodeDotInKeys&&"boolean"!=typeof e.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");const t=e.charset||ot.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let s=Ke;if(void 0!==e.format){if(!Ze.call(Ve,e.format))throw new TypeError("Unknown format option provided.");s=e.format}const n=Ve[s];let r,o=ot.filter;if(("function"==typeof e.filter||tt(e.filter))&&(o=e.filter),r=e.arrayFormat&&e.arrayFormat in et?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":ot.arrayFormat,"commaRoundTrip"in e&&"boolean"!=typeof e.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=void 0===e.allowDots?1==!!e.encodeDotInKeys||ot.allowDots:!!e.allowDots;return{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:ot.addQueryPrefix,allowDots:i,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:ot.allowEmptyArrays,arrayFormat:r,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:ot.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:void 0===e.delimiter?ot.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:ot.encode,encodeDotInKeys:"boolean"==typeof e.encodeDotInKeys?e.encodeDotInKeys:ot.encodeDotInKeys,encoder:"function"==typeof e.encoder?e.encoder:ot.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:ot.encodeValuesOnly,filter:o,format:s,formatter:n,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:ot.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:ot.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:ot.strictNullHandling}}(t);let r,o;"function"==typeof n.filter?(o=n.filter,s=o("",s)):tt(n.filter)&&(o=n.filter,r=o);const i=[];if("object"!=typeof s||null===s)return"";const a=et[n.arrayFormat],l="comma"===a&&n.commaRoundTrip;r||(r=Object.keys(s)),n.sort&&r.sort(n.sort);const c=new WeakMap;for(let h=0;h<r.length;++h){const e=r[h];n.skipNulls&&null===s[e]||nt(i,at(s[e],e,a,l,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,c))}const d=i.join(n.delimiter);let u=!0===n.addQueryPrefix?"?":"";return n.charsetSentinel&&("iso-8859-1"===n.charset?u+="utf8=%26%2310003%3B&":u+="utf8=%E2%9C%93&"),d.length>0?u+d:""}const ct="4.89.0";let dt,ut,ht,pt,ft,mt,gt,yt,wt,vt=!1;class xt{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}dt||function(e,t={auto:!1}){if(vt)throw new Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(dt)throw new Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${dt}'\``);vt=t.auto,dt=e.kind,ut=e.fetch,ht=e.FormData,pt=e.File,ft=e.ReadableStream,mt=e.getMultipartRequestOptions,gt=e.getDefaultAgent,yt=e.fileFromPath,wt=e.isFsReadStream}(function({manuallyImported:e}={}){const t=e?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let s,n,r,o;try{s=fetch,n=Request,r=Response,o=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${t}`)}return{kind:"web",fetch:s,Request:n,Response:r,Headers:o,FormData:"undefined"!=typeof FormData?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:"undefined"!=typeof Blob?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:"undefined"!=typeof File?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:"undefined"!=typeof ReadableStream?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(e,t)=>({...t,body:new xt(e)}),getDefaultAgent:e=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:e=>!1}}(),{auto:!0});class bt extends Error{}class _t extends bt{constructor(e,t,s,n){super(`${_t.makeMessage(e,t,s)}`),this.status=e,this.headers=n,this.request_id=null==n?void 0:n["x-request-id"],this.error=t;const r=t;this.code=null==r?void 0:r.code,this.param=null==r?void 0:r.param,this.type=null==r?void 0:r.type}static makeMessage(e,t,s){const n=(null==t?void 0:t.message)?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):s;return e&&n?`${e} ${n}`:e?`${e} status code (no body)`:n||"(no status code or body)"}static generate(e,t,s,n){if(!e||!n)return new Ct({message:s,cause:_s(t)});const r=null==t?void 0:t.error;return 400===e?new At(e,r,s,n):401===e?new Nt(e,r,s,n):403===e?new St(e,r,s,n):404===e?new It(e,r,s,n):409===e?new Ot(e,r,s,n):422===e?new Rt(e,r,s,n):429===e?new kt(e,r,s,n):e>=500?new Tt(e,r,s,n):new _t(e,r,s,n)}}class Et extends _t{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Ct extends _t{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class jt extends Ct{constructor({message:e}={}){super({message:e??"Request timed out."})}}class At extends _t{}class Nt extends _t{}class St extends _t{}class It extends _t{}class Ot extends _t{}class Rt extends _t{}class kt extends _t{}class Tt extends _t{}class Pt extends bt{constructor(){super("Could not parse response content as the length limit was reached")}}class $t extends bt{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var Mt,Lt=function(e,t,s,n,r){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?r.call(e,s):r?r.value=s:t.set(e,s),s},Dt=function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};class Ft{constructor(){Mt.set(this,void 0),this.buffer=new Uint8Array,Lt(this,Mt,null,"f")}decode(e){if(null==e)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?(new TextEncoder).encode(e):e;let s=new Uint8Array(this.buffer.length+t.length);s.set(this.buffer),s.set(t,this.buffer.length),this.buffer=s;const n=[];let r;for(;null!=(r=qt(this.buffer,Dt(this,Mt,"f")));){if(r.carriage&&null==Dt(this,Mt,"f")){Lt(this,Mt,r.index,"f");continue}if(null!=Dt(this,Mt,"f")&&(r.index!==Dt(this,Mt,"f")+1||r.carriage)){n.push(this.decodeText(this.buffer.slice(0,Dt(this,Mt,"f")-1))),this.buffer=this.buffer.slice(Dt(this,Mt,"f")),Lt(this,Mt,null,"f");continue}const e=null!==Dt(this,Mt,"f")?r.preceding-1:r.preceding,t=this.decodeText(this.buffer.slice(0,e));n.push(t),this.buffer=this.buffer.slice(r.index),Lt(this,Mt,null,"f")}return n}decodeText(e){if(null==e)return"";if("string"==typeof e)return e;if("undefined"!=typeof Buffer){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new bt(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!=typeof TextDecoder){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new bt(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new bt("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode("\n"):[]}}function qt(e,t){for(let s=t??0;s<e.length;s++){if(10===e[s])return{preceding:s,index:s+1,carriage:!1};if(13===e[s])return{preceding:s,index:s+1,carriage:!0}}return null}function Ut(e){for(let t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1])return t+2;if(13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return-1}function Bt(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const e=await t.read();return(null==e?void 0:e.done)&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){const e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}Mt=new WeakMap,Ft.NEWLINE_CHARS=new Set(["\n","\r"]),Ft.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class Ht{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let s=!1;return new Ht((async function*(){if(s)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let n=!1;try{for await(const s of async function*(e,t){if(!e.body)throw t.abort(),new bt("Attempted to iterate over a response with no body");const s=new Wt,n=new Ft,r=Bt(e.body);for await(const o of async function*(e){let t=new Uint8Array;for await(const s of e){if(null==s)continue;const e=s instanceof ArrayBuffer?new Uint8Array(s):"string"==typeof s?(new TextEncoder).encode(s):s;let n,r=new Uint8Array(t.length+e.length);for(r.set(t),r.set(e,t.length),t=r;-1!==(n=Ut(t));)yield t.slice(0,n),t=t.slice(n)}t.length>0&&(yield t)}(r))for(const e of n.decode(o)){const t=s.decode(e);t&&(yield t)}for(const o of n.flush()){const e=s.decode(o);e&&(yield e)}}(e,t))if(!n)if(s.data.startsWith("[DONE]"))n=!0;else if(null===s.event||s.event.startsWith("response.")){let e;try{e=JSON.parse(s.data)}catch(r){throw console.error("Could not parse message into JSON:",s.data),console.error("From chunk:",s.raw),r}if(e&&e.error)throw new _t(void 0,e.error,void 0,void 0);yield e}else{let e;try{e=JSON.parse(s.data)}catch(r){throw console.error("Could not parse message into JSON:",s.data),console.error("From chunk:",s.raw),r}if("error"==s.event)throw new _t(void 0,e.error,e.message,void 0);yield{event:s.event,data:e}}n=!0}catch(r){if(r instanceof Error&&"AbortError"===r.name)return;throw r}finally{n||t.abort()}}),t)}static fromReadableStream(e,t){let s=!1;return new Ht((async function*(){if(s)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let n=!1;try{for await(const t of async function*(){const t=new Ft,s=Bt(e);for await(const e of s)for(const s of t.decode(e))yield s;for(const e of t.flush())yield e}())n||t&&(yield JSON.parse(t));n=!0}catch(r){if(r instanceof Error&&"AbortError"===r.name)return;throw r}finally{n||t.abort()}}),t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],s=this.iterator(),n=n=>({next:()=>{if(0===n.length){const n=s.next();e.push(n),t.push(n)}return n.shift()}});return[new Ht((()=>n(e)),this.controller),new Ht((()=>n(t)),this.controller)]}toReadableStream(){const e=this;let t;const s=new TextEncoder;return new ft({async start(){t=e[Symbol.asyncIterator]()},async pull(e){try{const{value:n,done:r}=await t.next();if(r)return e.close();const o=s.encode(JSON.stringify(n)+"\n");e.enqueue(o)}catch(n){e.error(n)}},async cancel(){var e;await(null==(e=t.return)?void 0:e.call(t))}})}}class Wt{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,s,n]=function(e,t){const s=e.indexOf(t);if(-1!==s)return[e.substring(0,s),t,e.substring(s+t.length)];return[e,"",""]}(e,":");return n.startsWith(" ")&&(n=n.substring(1)),"event"===t?this.event=n:"data"===t&&this.data.push(n),null}}const zt=e=>null!=e&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob,Gt=e=>null!=e&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&Kt(e),Kt=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer;async function Vt(e,t,s){var n;if(e=await e,Gt(e))return e;if(zt(e)){const n=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");const r=Kt(n)?[await n.arrayBuffer()]:[n];return new pt(r,t,s)}const r=await async function(e){var t;let s=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)s.push(e);else if(Kt(e))s.push(await e.arrayBuffer());else{if(!Jt(e))throw new Error(`Unexpected data type: ${typeof e}; constructor: ${null==(t=null==e?void 0:e.constructor)?void 0:t.name}; props: ${function(e){const t=Object.getOwnPropertyNames(e);return`[${t.map((e=>`"${e}"`)).join(", ")}]`}(e)}`);for await(const t of e)s.push(t)}return s}(e);if(t||(t=function(e){var t;return Xt(e.name)||Xt(e.filename)||(null==(t=Xt(e.path))?void 0:t.split(/[\\/]/).pop())}(e)??"unknown_file"),!(null==s?void 0:s.type)){const e=null==(n=r[0])?void 0:n.type;"string"==typeof e&&(s={...s,type:e})}return new pt(r,t,s)}const Xt=e=>"string"==typeof e?e:"undefined"!=typeof Buffer&&e instanceof Buffer?String(e):void 0,Jt=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator],Yt=e=>e&&"object"==typeof e&&e.body&&"MultipartBody"===e[Symbol.toStringTag],Qt=async e=>{const t=await Zt(e.body);return mt(t,e)},Zt=async e=>{const t=new ht;return await Promise.all(Object.entries(e||{}).map((([e,s])=>es(t,e,s)))),t},es=async(e,t,s)=>{if(void 0!==s){if(null==s)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof s||"number"==typeof s||"boolean"==typeof s)e.append(t,String(s));else if((e=>Gt(e)||zt(e)||wt(e))(s)){const n=await Vt(s);e.append(t,n)}else if(Array.isArray(s))await Promise.all(s.map((s=>es(e,t+"[]",s))));else{if("object"!=typeof s)throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${s} instead`);await Promise.all(Object.entries(s).map((([s,n])=>es(e,`${t}[${s}]`,n))))}}};var ts,ss={};async function ns(e){var t;const{response:s}=e;if(e.options.stream)return Ss("response",s.status,s.url,s.headers,s.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(s,e.controller):Ht.fromSSEResponse(s,e.controller);if(204===s.status)return null;if(e.options.__binaryResponse)return s;const n=s.headers.get("content-type"),r=null==(t=null==n?void 0:n.split(";")[0])?void 0:t.trim();if((null==r?void 0:r.includes("application/json"))||(null==r?void 0:r.endsWith("+json"))){const e=await s.json();return Ss("response",s.status,s.url,s.headers,e),rs(e,s)}const o=await s.text();return Ss("response",s.status,s.url,s.headers,o),o}function rs(e,t){return!e||"object"!=typeof e||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}class os extends Promise{constructor(e,t=ns){super((e=>{e(null)})),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new os(this.responsePromise,(async t=>rs(e(await this.parseResponse(t),t),t.response)))}asResponse(){return this.responsePromise.then((e=>e.response))}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class is{constructor({baseURL:e,maxRetries:t=2,timeout:s=6e5,httpAgent:n,fetch:r}){this.baseURL=e,this.maxRetries=bs("maxRetries",t),this.timeout=bs("timeout",s),this.httpAgent=n,this.fetch=r??ut}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...gs(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Is()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,s){return this.request(Promise.resolve(s).then((async s=>{const n=s&&Kt(null==s?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(null==s?void 0:s.body)instanceof DataView?s.body:(null==s?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(null==s?void 0:s.body)?new DataView(s.body.buffer):null==s?void 0:s.body;return{method:e,path:t,...s,body:n}})))}getAPIList(e,t,s){return this.requestAPIList(t,{method:"get",path:e,...s})}calculateContentLength(e){if("string"==typeof e){if("undefined"!=typeof Buffer)return Buffer.byteLength(e,"utf8").toString();if("undefined"!=typeof TextEncoder){return(new TextEncoder).encode(e).length.toString()}}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var s;e={...e};const{method:n,path:r,query:o,headers:i={}}=e,a=ArrayBuffer.isView(e.body)||e.__binaryRequest&&"string"==typeof e.body?e.body:Yt(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,l=this.calculateContentLength(a),c=this.buildURL(r,o);"timeout"in e&&bs("timeout",e.timeout),e.timeout=e.timeout??this.timeout;const d=e.httpAgent??this.httpAgent??gt(c),u=e.timeout+1e3;"number"==typeof(null==(s=null==d?void 0:d.options)?void 0:s.timeout)&&u>(d.options.timeout??0)&&(d.options.timeout=u),this.idempotencyHeader&&"get"!==n&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);return{req:{method:n,...a&&{body:a},headers:this.buildHeaders({options:e,headers:i,contentLength:l,retryCount:t}),...d&&{agent:d},signal:e.signal??null},url:c,timeout:e.timeout}}buildHeaders({options:e,headers:t,contentLength:s,retryCount:n}){const r={};s&&(r["content-length"]=s);const o=this.defaultHeaders(e);return As(r,o),As(r,t),Yt(e.body)&&"node"!==dt&&delete r["content-type"],void 0===Os(o,"x-stainless-retry-count")&&void 0===Os(t,"x-stainless-retry-count")&&(r["x-stainless-retry-count"]=String(n)),void 0===Os(o,"x-stainless-timeout")&&void 0===Os(t,"x-stainless-timeout")&&e.timeout&&(r["x-stainless-timeout"]=String(e.timeout)),this.validateHeaders(r,t),r}async prepareOptions(e){}async prepareRequest(e,{url:t,options:s}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map((e=>[...e]))):{...e}:{}}makeStatusError(e,t,s,n){return _t.generate(e,t,s,n)}request(e,t=null){return new os(this.makeRequest(e,t))}async makeRequest(e,t){var s,n;const r=await e,o=r.maxRetries??this.maxRetries;null==t&&(t=o),await this.prepareOptions(r);const{req:i,url:a,timeout:l}=this.buildRequest(r,{retryCount:o-t});if(await this.prepareRequest(i,{url:a,options:r}),Ss("request",a,r,i.headers),null==(s=r.signal)?void 0:s.aborted)throw new Et;const c=new AbortController,d=await this.fetchWithTimeout(a,i,l,c).catch(_s);if(d instanceof Error){if(null==(n=r.signal)?void 0:n.aborted)throw new Et;if(t)return this.retryRequest(r,t);if("AbortError"===d.name)throw new jt;throw new Ct({cause:d})}const u=cs(d.headers);if(!d.ok){if(t&&this.shouldRetry(d)){return Ss(`response (error; ${`retrying, ${t} attempts remaining`})`,d.status,a,u),this.retryRequest(r,t,u)}const e=await d.text().catch((e=>_s(e).message)),s=ys(e),n=s?void 0:e;Ss(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,d.status,a,u,n);throw this.makeStatusError(d.status,s,n,u)}return{response:d,options:r,controller:c}}requestAPIList(e,t){const s=this.makeRequest(t,null);return new ls(this,s,e)}buildURL(e,t){const s=vs(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),n=this.defaultQuery();return Cs(n)||(t={...n,...t}),"object"==typeof t&&t&&!Array.isArray(t)&&(s.search=this.stringifyQuery(t)),s.toString()}stringifyQuery(e){return Object.entries(e).filter((([e,t])=>void 0!==t)).map((([e,t])=>{if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw new bt(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)})).join("&")}async fetchWithTimeout(e,t,s,n){const{signal:r,...o}=t||{};r&&r.addEventListener("abort",(()=>n.abort()));const i=setTimeout((()=>n.abort()),s),a={signal:n.signal,...o};return a.method&&(a.method=a.method.toUpperCase()),this.fetch.call(void 0,e,a).finally((()=>{clearTimeout(i)}))}shouldRetry(e){const t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||(409===e.status||(429===e.status||e.status>=500)))}async retryRequest(e,t,s){let n;const r=null==s?void 0:s["retry-after-ms"];if(r){const e=parseFloat(r);Number.isNaN(e)||(n=e)}const o=null==s?void 0:s["retry-after"];if(o&&!n){const e=parseFloat(o);n=Number.isNaN(e)?Date.parse(o)-Date.now():1e3*e}if(!(n&&0<=n&&n<6e4)){const s=e.maxRetries??this.maxRetries;n=this.calculateDefaultRetryTimeoutMillis(t,s)}return await xs(n),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const s=t-e;return Math.min(.5*Math.pow(2,s),8)*(1-.25*Math.random())*1e3}getUserAgent(){return`${this.constructor.name}/JS ${ct}`}}class as{constructor(e,t,s,n){ts.set(this,void 0),function(e,t,s){if("function"==typeof t||!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");t.set(e,s)}(this,ts,e),this.options=n,this.response=t,this.body=s}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageInfo()}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new bt("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&"object"==typeof t.query)t.query={...t.query,...e.params};else if("url"in e){const s=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[t,n]of s)e.url.searchParams.set(t,n);t.query=void 0,t.path=e.url.toString()}return await function(e,t,s,n){if("function"==typeof t||!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)}(this,ts,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(ts=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class ls extends os{constructor(e,t,s){super(t,(async t=>new s(e,t.response,await ns(t),t.options)))}async*[Symbol.asyncIterator](){const e=await(this);for await(const t of e)yield t}}const cs=e=>new Proxy(Object.fromEntries(e.entries()),{get(e,t){const s=t.toString();return e[s.toLowerCase()]||e[s]}}),ds={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},us=e=>"object"==typeof e&&null!==e&&!Cs(e)&&Object.keys(e).every((e=>js(ds,e))),hs=()=>{var e;if("undefined"!=typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ct,"X-Stainless-OS":fs(Deno.build.os),"X-Stainless-Arch":ps(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:(null==(e=Deno.version)?void 0:e.deno)??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ct,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if("[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ct,"X-Stainless-OS":fs(process.platform),"X-Stainless-Arch":ps(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=function(){if("undefined"==typeof navigator||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:s}of e){const e=s.exec(navigator.userAgent);if(e){return{browser:t,version:`${e[1]||0}.${e[2]||0}.${e[3]||0}`}}}return null}();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ct,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ct,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};const ps=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",fs=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown";let ms;const gs=()=>ms??(ms=hs()),ys=e=>{try{return JSON.parse(e)}catch(t){return}},ws=/^[a-z][a-z0-9+.-]*:/i,vs=e=>ws.test(e),xs=e=>new Promise((t=>setTimeout(t,e))),bs=(e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new bt(`${e} must be an integer`);if(t<0)throw new bt(`${e} must be a positive integer`);return t},_s=e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e)try{return new Error(JSON.stringify(e))}catch{}return new Error(e)},Es=e=>{var t,s,n,r;return"undefined"!=typeof process?(null==(t=null==ss?void 0:ss[e])?void 0:t.trim())??void 0:"undefined"!=typeof Deno?null==(r=null==(n=null==(s=Deno.env)?void 0:s.get)?void 0:n.call(s,e))?void 0:r.trim():void 0};function Cs(e){if(!e)return!0;for(const t in e)return!1;return!0}function js(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function As(e,t){for(const s in t){if(!js(t,s))continue;const n=s.toLowerCase();if(!n)continue;const r=t[s];null===r?delete e[n]:void 0!==r&&(e[n]=r)}}const Ns=new Set(["authorization","api-key"]);function Ss(e,...t){if("undefined"!=typeof process&&"true"===(null==ss?void 0:ss.DEBUG)){const s=t.map((e=>{if(!e)return e;if(e.headers){const t={...e,headers:{...e.headers}};for(const s in e.headers)Ns.has(s.toLowerCase())&&(t.headers[s]="REDACTED");return t}let t=null;for(const s in e)Ns.has(s.toLowerCase())&&(t??(t={...e}),t[s]="REDACTED");return t??e}));console.log(`OpenAI:DEBUG:${e}`,...s)}}const Is=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),Os=(e,t)=>{var s;const n=t.toLowerCase();if((e=>"function"==typeof(null==e?void 0:e.get))(e)){const r=(null==(s=t[0])?void 0:s.toUpperCase())+t.substring(1).replace(/([^\w])(\w)/g,((e,t,s)=>t+s.toUpperCase()));for(const s of[t,n,t.toUpperCase(),r]){const t=e.get(s);if(t)return t}}for(const[r,o]of Object.entries(e))if(r.toLowerCase()===n)return Array.isArray(o)?(o.length<=1||console.warn(`Received ${o.length} entries for the ${t} header, using the first entry.`),o[0]):o};function Rs(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)}class ks extends as{constructor(e,t,s,n){super(e,t,s,n),this.data=s.data||[],this.object=s.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Ts extends as{constructor(e,t,s,n){super(e,t,s,n),this.data=s.data||[],this.has_more=s.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var e;const t=this.getPaginatedItems();if(!t.length)return null;const s=null==(e=t[t.length-1])?void 0:e.id;return s?{params:{after:s}}:null}}class Ps{constructor(e){this._client=e}}let $s=class extends Ps{list(e,t={},s){return us(t)?this.list(e,{},t):this._client.getAPIList(`/chat/completions/${e}/messages`,Ds,{query:t,...s})}},Ms=class extends Ps{constructor(){super(...arguments),this.messages=new $s(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(`/chat/completions/${e}`,t)}update(e,t,s){return this._client.post(`/chat/completions/${e}`,{body:t,...s})}list(e={},t){return us(e)?this.list({},e):this._client.getAPIList("/chat/completions",Ls,{query:e,...t})}del(e,t){return this._client.delete(`/chat/completions/${e}`,t)}};class Ls extends Ts{}class Ds extends Ts{}Ms.ChatCompletionsPage=Ls,Ms.Messages=$s;let Fs=class extends Ps{constructor(){super(...arguments),this.completions=new Ms(this._client)}};Fs.Completions=Ms,Fs.ChatCompletionsPage=Ls;class qs extends Ps{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...null==t?void 0:t.headers},__binaryResponse:!0})}}class Us extends Ps{create(e,t){return this._client.post("/audio/transcriptions",Qt({body:e,...t,__metadata:{model:e.model}}))}}class Bs extends Ps{create(e,t){return this._client.post("/audio/translations",Qt({body:e,...t,__metadata:{model:e.model}}))}}class Hs extends Ps{constructor(){super(...arguments),this.transcriptions=new Us(this._client),this.translations=new Bs(this._client),this.speech=new qs(this._client)}}Hs.Transcriptions=Us,Hs.Translations=Bs,Hs.Speech=qs;class Ws extends Ps{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return us(e)?this.list({},e):this._client.getAPIList("/batches",zs,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class zs extends Ts{}Ws.BatchesPage=zs;class Gs extends Ps{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...null==t?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...null==t?void 0:t.headers}})}update(e,t,s){return this._client.post(`/assistants/${e}`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...null==s?void 0:s.headers}})}list(e={},t){return us(e)?this.list({},e):this._client.getAPIList("/assistants",Ks,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...null==t?void 0:t.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...null==t?void 0:t.headers}})}}class Ks extends Ts{}function Vs(e){return"function"==typeof e.parse}Gs.AssistantsPage=Ks;const Xs=e=>"assistant"===(null==e?void 0:e.role),Js=e=>"function"===(null==e?void 0:e.role),Ys=e=>"tool"===(null==e?void 0:e.role);var Qs,Zs,en,tn,sn,nn,rn,on,an,ln,cn,dn,un,hn=function(e,t,s,n,r){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?r.call(e,s):r?r.value=s:t.set(e,s),s},pn=function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};class fn{constructor(){Qs.add(this),this.controller=new AbortController,Zs.set(this,void 0),en.set(this,(()=>{})),tn.set(this,(()=>{})),sn.set(this,void 0),nn.set(this,(()=>{})),rn.set(this,(()=>{})),on.set(this,{}),an.set(this,!1),ln.set(this,!1),cn.set(this,!1),dn.set(this,!1),hn(this,Zs,new Promise(((e,t)=>{hn(this,en,e,"f"),hn(this,tn,t,"f")})),"f"),hn(this,sn,new Promise(((e,t)=>{hn(this,nn,e,"f"),hn(this,rn,t,"f")})),"f"),pn(this,Zs,"f").catch((()=>{})),pn(this,sn,"f").catch((()=>{}))}_run(e){setTimeout((()=>{e().then((()=>{this._emitFinal(),this._emit("end")}),pn(this,Qs,"m",un).bind(this))}),0)}_connected(){this.ended||(pn(this,en,"f").call(this),this._emit("connect"))}get ended(){return pn(this,an,"f")}get errored(){return pn(this,ln,"f")}get aborted(){return pn(this,cn,"f")}abort(){this.controller.abort()}on(e,t){return(pn(this,on,"f")[e]||(pn(this,on,"f")[e]=[])).push({listener:t}),this}off(e,t){const s=pn(this,on,"f")[e];if(!s)return this;const n=s.findIndex((e=>e.listener===t));return n>=0&&s.splice(n,1),this}once(e,t){return(pn(this,on,"f")[e]||(pn(this,on,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise(((t,s)=>{hn(this,dn,!0,"f"),"error"!==e&&this.once("error",s),this.once(e,t)}))}async done(){hn(this,dn,!0,"f"),await pn(this,sn,"f")}_emit(e,...t){if(pn(this,an,"f"))return;"end"===e&&(hn(this,an,!0,"f"),pn(this,nn,"f").call(this));const s=pn(this,on,"f")[e];if(s&&(pn(this,on,"f")[e]=s.filter((e=>!e.once)),s.forEach((({listener:e})=>e(...t)))),"abort"===e){const e=t[0];return pn(this,dn,"f")||(null==s?void 0:s.length)||Promise.reject(e),pn(this,tn,"f").call(this,e),pn(this,rn,"f").call(this,e),void this._emit("end")}if("error"===e){const e=t[0];pn(this,dn,"f")||(null==s?void 0:s.length)||Promise.reject(e),pn(this,tn,"f").call(this,e),pn(this,rn,"f").call(this,e),this._emit("end")}}_emitFinal(){}}function mn(e){return"auto-parseable-response-format"===(null==e?void 0:e.$brand)}function gn(e){return"auto-parseable-tool"===(null==e?void 0:e.$brand)}function yn(e,t){const s=e.choices.map((e=>{var s;if("length"===e.finish_reason)throw new Pt;if("content_filter"===e.finish_reason)throw new $t;return{...e,message:{...e.message,...e.message.tool_calls?{tool_calls:(null==(s=e.message.tool_calls)?void 0:s.map((e=>function(e,t){var s;const n=null==(s=e.tools)?void 0:s.find((e=>{var s;return(null==(s=e.function)?void 0:s.name)===t.function.name}));return{...t,function:{...t.function,parsed_arguments:gn(n)?n.$parseRaw(t.function.arguments):(null==n?void 0:n.function.strict)?JSON.parse(t.function.arguments):null}}}(t,e))))??void 0}:void 0,parsed:e.message.content&&!e.message.refusal?wn(t,e.message.content):null}}}));return{...e,choices:s}}function wn(e,t){var s,n;if("json_schema"!==(null==(s=e.response_format)?void 0:s.type))return null;if("json_schema"===(null==(n=e.response_format)?void 0:n.type)){if("$parseRaw"in e.response_format){return e.response_format.$parseRaw(t)}return JSON.parse(t)}return null}function vn(e,t){var s;if(!e)return!1;const n=null==(s=e.tools)?void 0:s.find((e=>{var s;return(null==(s=e.function)?void 0:s.name)===t.function.name}));return gn(n)||(null==n?void 0:n.function.strict)||!1}function xn(e){var t;return!!mn(e.response_format)||((null==(t=e.tools)?void 0:t.some((e=>gn(e)||"function"===e.type&&!0===e.function.strict)))??!1)}Zs=new WeakMap,en=new WeakMap,tn=new WeakMap,sn=new WeakMap,nn=new WeakMap,rn=new WeakMap,on=new WeakMap,an=new WeakMap,ln=new WeakMap,cn=new WeakMap,dn=new WeakMap,Qs=new WeakSet,un=function(e){if(hn(this,ln,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new Et),e instanceof Et)return hn(this,cn,!0,"f"),this._emit("abort",e);if(e instanceof bt)return this._emit("error",e);if(e instanceof Error){const t=new bt(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new bt(String(e)))};var bn,_n,En,Cn,jn,An,Nn,Sn,In=function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};const On=10;class Rn extends fn{constructor(){super(...arguments),bn.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var t;this._chatCompletions.push(e),this._emit("chatCompletion",e);const s=null==(t=e.choices[0])?void 0:t.message;return s&&this._addMessage(s),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t)if(this._emit("message",e),(Js(e)||Ys(e))&&e.content)this._emit("functionCallResult",e.content);else if(Xs(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Xs(e)&&e.tool_calls)for(const s of e.tool_calls)"function"===s.type&&this._emit("functionCall",s.function)}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new bt("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),In(this,bn,"m",_n).call(this)}async finalMessage(){return await this.done(),In(this,bn,"m",En).call(this)}async finalFunctionCall(){return await this.done(),In(this,bn,"m",Cn).call(this)}async finalFunctionCallResult(){return await this.done(),In(this,bn,"m",jn).call(this)}async totalUsage(){return await this.done(),In(this,bn,"m",An).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=In(this,bn,"m",En).call(this);t&&this._emit("finalMessage",t);const s=In(this,bn,"m",_n).call(this);s&&this._emit("finalContent",s);const n=In(this,bn,"m",Cn).call(this);n&&this._emit("finalFunctionCall",n);const r=In(this,bn,"m",jn).call(this);null!=r&&this._emit("finalFunctionCallResult",r),this._chatCompletions.some((e=>e.usage))&&this._emit("totalUsage",In(this,bn,"m",An).call(this))}async _createChatCompletion(e,t,s){const n=null==s?void 0:s.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),In(this,bn,"m",Nn).call(this,t);const r=await e.chat.completions.create({...t,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addChatCompletion(yn(r,t))}async _runChatCompletion(e,t,s){for(const n of t.messages)this._addMessage(n,!1);return await this._createChatCompletion(e,t,s)}async _runFunctions(e,t,s){var n;const r="function",{function_call:o="auto",stream:i,...a}=t,l="string"!=typeof o&&(null==o?void 0:o.name),{maxChatCompletions:c=On}=s||{},d={};for(const p of t.functions)d[p.name||p.function.name]=p;const u=t.functions.map((e=>({name:e.name||e.function.name,parameters:e.parameters,description:e.description})));for(const p of t.messages)this._addMessage(p,!1);for(let p=0;p<c;++p){const t=null==(n=(await this._createChatCompletion(e,{...a,function_call:o,functions:u,messages:[...this.messages]},s)).choices[0])?void 0:n.message;if(!t)throw new bt("missing message in ChatCompletion response");if(!t.function_call)return;const{name:i,arguments:c}=t.function_call,p=d[i];if(!p){const e=`Invalid function_call: ${JSON.stringify(i)}. Available options are: ${u.map((e=>JSON.stringify(e.name))).join(", ")}. Please try again`;this._addMessage({role:r,name:i,content:e});continue}if(l&&l!==i){const e=`Invalid function_call: ${JSON.stringify(i)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:r,name:i,content:e});continue}let f;try{f=Vs(p)?await p.parse(c):c}catch(h){this._addMessage({role:r,name:i,content:h instanceof Error?h.message:String(h)});continue}const m=await p.function(f,this),g=In(this,bn,"m",Sn).call(this,m);if(this._addMessage({role:r,name:i,content:g}),l)return}}async _runTools(e,t,s){var n,r,o;const i="tool",{tool_choice:a="auto",stream:l,...c}=t,d="string"!=typeof a&&(null==(n=null==a?void 0:a.function)?void 0:n.name),{maxChatCompletions:u=On}=s||{},h=t.tools.map((e=>{if(gn(e)){if(!e.$callback)throw new bt("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:e.$callback,name:e.function.name,description:e.function.description||"",parameters:e.function.parameters,parse:e.$parseRaw,strict:!0}}}return e})),p={};for(const g of h)"function"===g.type&&(p[g.function.name||g.function.function.name]=g.function);const f="tools"in t?h.map((e=>"function"===e.type?{type:"function",function:{name:e.function.name||e.function.function.name,parameters:e.function.parameters,description:e.function.description,strict:e.function.strict}}:e)):void 0;for(const g of t.messages)this._addMessage(g,!1);for(let g=0;g<u;++g){const t=null==(r=(await this._createChatCompletion(e,{...c,tool_choice:a,tools:f,messages:[...this.messages]},s)).choices[0])?void 0:r.message;if(!t)throw new bt("missing message in ChatCompletion response");if(!(null==(o=t.tool_calls)?void 0:o.length))return;for(const e of t.tool_calls){if("function"!==e.type)continue;const t=e.id,{name:s,arguments:n}=e.function,r=p[s];if(!r){const e=`Invalid tool_call: ${JSON.stringify(s)}. Available options are: ${Object.keys(p).map((e=>JSON.stringify(e))).join(", ")}. Please try again`;this._addMessage({role:i,tool_call_id:t,content:e});continue}if(d&&d!==s){const e=`Invalid tool_call: ${JSON.stringify(s)}. ${JSON.stringify(d)} requested. Please try again`;this._addMessage({role:i,tool_call_id:t,content:e});continue}let o;try{o=Vs(r)?await r.parse(n):n}catch(m){const e=m instanceof Error?m.message:String(m);this._addMessage({role:i,tool_call_id:t,content:e});continue}const a=await r.function(o,this),l=In(this,bn,"m",Sn).call(this,a);if(this._addMessage({role:i,tool_call_id:t,content:l}),d)return}}}}bn=new WeakSet,_n=function(){return In(this,bn,"m",En).call(this).content??null},En=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(Xs(t)){const{function_call:e,...s}=t,n={...s,content:t.content??null,refusal:t.refusal??null};return e&&(n.function_call=e),n}}throw new bt("stream ended without producing a ChatCompletionMessage with role=assistant")},Cn=function(){var e,t;for(let s=this.messages.length-1;s>=0;s--){const n=this.messages[s];if(Xs(n)&&(null==n?void 0:n.function_call))return n.function_call;if(Xs(n)&&(null==(e=null==n?void 0:n.tool_calls)?void 0:e.length))return null==(t=n.tool_calls.at(-1))?void 0:t.function}},jn=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(Js(t)&&null!=t.content)return t.content;if(Ys(t)&&null!=t.content&&"string"==typeof t.content&&this.messages.some((e=>{var s;return"assistant"===e.role&&(null==(s=e.tool_calls)?void 0:s.some((e=>"function"===e.type&&e.id===t.tool_call_id)))})))return t.content}},An=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},Nn=function(e){if(null!=e.n&&e.n>1)throw new bt("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Sn=function(e){return"string"==typeof e?e:void 0===e?"undefined":JSON.stringify(e)};class kn extends Rn{static runFunctions(e,t,s){const n=new kn,r={...s,headers:{...null==s?void 0:s.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run((()=>n._runFunctions(e,t,r))),n}static runTools(e,t,s){const n=new kn,r={...s,headers:{...null==s?void 0:s.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run((()=>n._runTools(e,t,r))),n}_addMessage(e,t=!0){super._addMessage(e,t),Xs(e)&&e.content&&this._emit("content",e.content)}}const Tn=1,Pn=2,$n=4,Mn=8,Ln=16,Dn=32,Fn=64,qn=128,Un=256,Bn=511;class Hn extends Error{}class Wn extends Error{}const zn=(e,t)=>{const s=e.length;let n=0;const r=e=>{throw new Hn(`${e} at position ${n}`)},o=e=>{throw new Wn(`${e} at position ${n}`)},i=()=>(u(),n>=s&&r("Unexpected end of input"),'"'===e[n]?a():"{"===e[n]?l():"["===e[n]?c():"null"===e.substring(n,n+4)||Ln&t&&s-n<4&&"null".startsWith(e.substring(n))?(n+=4,null):"true"===e.substring(n,n+4)||Dn&t&&s-n<4&&"true".startsWith(e.substring(n))?(n+=4,!0):"false"===e.substring(n,n+5)||Dn&t&&s-n<5&&"false".startsWith(e.substring(n))?(n+=5,!1):"Infinity"===e.substring(n,n+8)||qn&t&&s-n<8&&"Infinity".startsWith(e.substring(n))?(n+=8,1/0):"-Infinity"===e.substring(n,n+9)||Un&t&&1<s-n&&s-n<9&&"-Infinity".startsWith(e.substring(n))?(n+=9,-1/0):"NaN"===e.substring(n,n+3)||Fn&t&&s-n<3&&"NaN".startsWith(e.substring(n))?(n+=3,NaN):d()),a=()=>{const i=n;let a=!1;for(n++;n<s&&('"'!==e[n]||a&&"\\"===e[n-1]);)a="\\"===e[n]&&!a,n++;if('"'==e.charAt(n))try{return JSON.parse(e.substring(i,++n-Number(a)))}catch(l){o(String(l))}else if(Tn&t)try{return JSON.parse(e.substring(i,n-Number(a))+'"')}catch(l){return JSON.parse(e.substring(i,e.lastIndexOf("\\"))+'"')}r("Unterminated string literal")},l=()=>{n++,u();const o={};try{for(;"}"!==e[n];){if(u(),n>=s&&Mn&t)return o;const r=a();u(),n++;try{const e=i();Object.defineProperty(o,r,{value:e,writable:!0,enumerable:!0,configurable:!0})}catch(l){if(Mn&t)return o;throw l}u(),","===e[n]&&n++}}catch(l){if(Mn&t)return o;r("Expected '}' at end of object")}return n++,o},c=()=>{n++;const s=[];try{for(;"]"!==e[n];)s.push(i()),u(),","===e[n]&&n++}catch(o){if($n&t)return s;r("Expected ']' at end of array")}return n++,s},d=()=>{if(0===n){"-"===e&&Pn&t&&r("Not sure what '-' is");try{return JSON.parse(e)}catch(a){if(Pn&t)try{return"."===e[e.length-1]?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch(l){}o(String(a))}}const i=n;for("-"===e[n]&&n++;e[n]&&!",]}".includes(e[n]);)n++;n!=s||Pn&t||r("Unterminated number literal");try{return JSON.parse(e.substring(i,n))}catch(a){"-"===e.substring(i,n)&&Pn&t&&r("Not sure what '-' is");try{return JSON.parse(e.substring(i,e.lastIndexOf("e")))}catch(l){o(String(l))}}},u=()=>{for(;n<s&&" \n\r\t".includes(e[n]);)n++};return i()},Gn=e=>function(e,t=Bn){if("string"!=typeof e)throw new TypeError("expecting str, got "+typeof e);if(!e.trim())throw new Error(`${e} is empty`);return zn(e.trim(),t)}(e,Bn^Pn);var Kn,Vn,Xn,Jn,Yn,Qn,Zn,er,tr,sr,nr,rr,or=function(e,t,s,n,r){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?r.call(e,s):r?r.value=s:t.set(e,s),s},ir=function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};class ar extends Rn{constructor(e){super(),Kn.add(this),Vn.set(this,void 0),Xn.set(this,void 0),Jn.set(this,void 0),or(this,Vn,e,"f"),or(this,Xn,[],"f")}get currentChatCompletionSnapshot(){return ir(this,Jn,"f")}static fromReadableStream(e){const t=new ar(null);return t._run((()=>t._fromReadableStream(e))),t}static createChatCompletion(e,t,s){const n=new ar(t);return n._run((()=>n._runChatCompletion(e,{...t,stream:!0},{...s,headers:{...null==s?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}}))),n}async _createChatCompletion(e,t,s){var n;super._createChatCompletion;const r=null==s?void 0:s.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),ir(this,Kn,"m",Yn).call(this);const o=await e.chat.completions.create({...t,stream:!0},{...s,signal:this.controller.signal});this._connected();for await(const i of o)ir(this,Kn,"m",Zn).call(this,i);if(null==(n=o.controller.signal)?void 0:n.aborted)throw new Et;return this._addChatCompletion(ir(this,Kn,"m",sr).call(this))}async _fromReadableStream(e,t){var s;const n=null==t?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),ir(this,Kn,"m",Yn).call(this),this._connected();const r=Ht.fromReadableStream(e,this.controller);let o;for await(const i of r)o&&o!==i.id&&this._addChatCompletion(ir(this,Kn,"m",sr).call(this)),ir(this,Kn,"m",Zn).call(this,i),o=i.id;if(null==(s=r.controller.signal)?void 0:s.aborted)throw new Et;return this._addChatCompletion(ir(this,Kn,"m",sr).call(this))}[(Vn=new WeakMap,Xn=new WeakMap,Jn=new WeakMap,Kn=new WeakSet,Yn=function(){this.ended||or(this,Jn,void 0,"f")},Qn=function(e){let t=ir(this,Xn,"f")[e.index];return t||(t={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},ir(this,Xn,"f")[e.index]=t,t)},Zn=function(e){var t,s,n,r,o,i,a,l,c,d,u,h,p,f,m;if(this.ended)return;const g=ir(this,Kn,"m",rr).call(this,e);this._emit("chunk",e,g);for(const y of e.choices){const e=g.choices[y.index];null!=y.delta.content&&"assistant"===(null==(t=e.message)?void 0:t.role)&&(null==(s=e.message)?void 0:s.content)&&(this._emit("content",y.delta.content,e.message.content),this._emit("content.delta",{delta:y.delta.content,snapshot:e.message.content,parsed:e.message.parsed})),null!=y.delta.refusal&&"assistant"===(null==(n=e.message)?void 0:n.role)&&(null==(r=e.message)?void 0:r.refusal)&&this._emit("refusal.delta",{delta:y.delta.refusal,snapshot:e.message.refusal}),null!=(null==(o=y.logprobs)?void 0:o.content)&&"assistant"===(null==(i=e.message)?void 0:i.role)&&this._emit("logprobs.content.delta",{content:null==(a=y.logprobs)?void 0:a.content,snapshot:(null==(l=e.logprobs)?void 0:l.content)??[]}),null!=(null==(c=y.logprobs)?void 0:c.refusal)&&"assistant"===(null==(d=e.message)?void 0:d.role)&&this._emit("logprobs.refusal.delta",{refusal:null==(u=y.logprobs)?void 0:u.refusal,snapshot:(null==(h=e.logprobs)?void 0:h.refusal)??[]});const w=ir(this,Kn,"m",Qn).call(this,e);e.finish_reason&&(ir(this,Kn,"m",tr).call(this,e),null!=w.current_tool_call_index&&ir(this,Kn,"m",er).call(this,e,w.current_tool_call_index));for(const t of y.delta.tool_calls??[])w.current_tool_call_index!==t.index&&(ir(this,Kn,"m",tr).call(this,e),null!=w.current_tool_call_index&&ir(this,Kn,"m",er).call(this,e,w.current_tool_call_index)),w.current_tool_call_index=t.index;for(const t of y.delta.tool_calls??[]){const s=null==(p=e.message.tool_calls)?void 0:p[t.index];(null==s?void 0:s.type)&&("function"===(null==s?void 0:s.type)?this._emit("tool_calls.function.arguments.delta",{name:null==(f=s.function)?void 0:f.name,index:t.index,arguments:s.function.arguments,parsed_arguments:s.function.parsed_arguments,arguments_delta:(null==(m=t.function)?void 0:m.arguments)??""}):null==s||s.type)}}},er=function(e,t){var s,n,r;if(ir(this,Kn,"m",Qn).call(this,e).done_tool_calls.has(t))return;const o=null==(s=e.message.tool_calls)?void 0:s[t];if(!o)throw new Error("no tool call snapshot");if(!o.type)throw new Error("tool call snapshot missing `type`");if("function"===o.type){const e=null==(r=null==(n=ir(this,Vn,"f"))?void 0:n.tools)?void 0:r.find((e=>"function"===e.type&&e.function.name===o.function.name));this._emit("tool_calls.function.arguments.done",{name:o.function.name,index:t,arguments:o.function.arguments,parsed_arguments:gn(e)?e.$parseRaw(o.function.arguments):(null==e?void 0:e.function.strict)?JSON.parse(o.function.arguments):null})}else o.type},tr=function(e){var t,s;const n=ir(this,Kn,"m",Qn).call(this,e);if(e.message.content&&!n.content_done){n.content_done=!0;const t=ir(this,Kn,"m",nr).call(this);this._emit("content.done",{content:e.message.content,parsed:t?t.$parseRaw(e.message.content):null})}e.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:e.message.refusal})),(null==(t=e.logprobs)?void 0:t.content)&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:e.logprobs.content})),(null==(s=e.logprobs)?void 0:s.refusal)&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:e.logprobs.refusal}))},sr=function(){if(this.ended)throw new bt("stream has ended, this shouldn't happen");const e=ir(this,Jn,"f");if(!e)throw new bt("request ended without sending any chunks");return or(this,Jn,void 0,"f"),or(this,Xn,[],"f"),function(e,t){const{id:s,choices:n,created:r,model:o,system_fingerprint:i,...a}=e,l={...a,id:s,choices:n.map((({message:t,finish_reason:s,index:n,logprobs:r,...o})=>{if(!s)throw new bt(`missing finish_reason for choice ${n}`);const{content:i=null,function_call:a,tool_calls:l,...c}=t,d=t.role;if(!d)throw new bt(`missing role for choice ${n}`);if(a){const{arguments:e,name:l}=a;if(null==e)throw new bt(`missing function_call.arguments for choice ${n}`);if(!l)throw new bt(`missing function_call.name for choice ${n}`);return{...o,message:{content:i,function_call:{arguments:e,name:l},role:d,refusal:t.refusal??null},finish_reason:s,index:n,logprobs:r}}return l?{...o,index:n,finish_reason:s,logprobs:r,message:{...c,role:d,content:i,refusal:t.refusal??null,tool_calls:l.map(((t,s)=>{const{function:r,type:o,id:i,...a}=t,{arguments:l,name:c,...d}=r||{};if(null==i)throw new bt(`missing choices[${n}].tool_calls[${s}].id\n${lr(e)}`);if(null==o)throw new bt(`missing choices[${n}].tool_calls[${s}].type\n${lr(e)}`);if(null==c)throw new bt(`missing choices[${n}].tool_calls[${s}].function.name\n${lr(e)}`);if(null==l)throw new bt(`missing choices[${n}].tool_calls[${s}].function.arguments\n${lr(e)}`);return{...a,id:i,type:o,function:{...d,name:c,arguments:l}}}))}}:{...o,message:{...c,content:i,role:d,refusal:t.refusal??null},finish_reason:s,index:n,logprobs:r}})),created:r,model:o,object:"chat.completion",...i?{system_fingerprint:i}:{}};return function(e,t){return t&&xn(t)?yn(e,t):{...e,choices:e.choices.map((e=>({...e,message:{...e.message,parsed:null,...e.message.tool_calls?{tool_calls:e.message.tool_calls}:void 0}})))}}(l,t)}(e,ir(this,Vn,"f"))},nr=function(){var e;const t=null==(e=ir(this,Vn,"f"))?void 0:e.response_format;return mn(t)?t:null},rr=function(e){var t,s,n,r;let o=ir(this,Jn,"f");const{choices:i,...a}=e;o?Object.assign(o,a):o=or(this,Jn,{...a,choices:[]},"f");for(const{delta:l,finish_reason:c,index:d,logprobs:u=null,...h}of e.choices){let e=o.choices[d];if(e||(e=o.choices[d]={finish_reason:c,index:d,message:{},logprobs:u,...h}),u)if(e.logprobs){const{content:n,refusal:r,...o}=u;Object.assign(e.logprobs,o),n&&((t=e.logprobs).content??(t.content=[]),e.logprobs.content.push(...n)),r&&((s=e.logprobs).refusal??(s.refusal=[]),e.logprobs.refusal.push(...r))}else e.logprobs=Object.assign({},u);if(c&&(e.finish_reason=c,ir(this,Vn,"f")&&xn(ir(this,Vn,"f")))){if("length"===c)throw new Pt;if("content_filter"===c)throw new $t}if(Object.assign(e,h),!l)continue;const{content:i,refusal:a,function_call:p,role:f,tool_calls:m,...g}=l;if(Object.assign(e.message,g),a&&(e.message.refusal=(e.message.refusal||"")+a),f&&(e.message.role=f),p&&(e.message.function_call?(p.name&&(e.message.function_call.name=p.name),p.arguments&&((n=e.message.function_call).arguments??(n.arguments=""),e.message.function_call.arguments+=p.arguments)):e.message.function_call=p),i&&(e.message.content=(e.message.content||"")+i,!e.message.refusal&&ir(this,Kn,"m",nr).call(this)&&(e.message.parsed=Gn(e.message.content))),m){e.message.tool_calls||(e.message.tool_calls=[]);for(const{index:t,id:s,type:n,function:o,...i}of m){const a=(r=e.message.tool_calls)[t]??(r[t]={});Object.assign(a,i),s&&(a.id=s),n&&(a.type=n),o&&(a.function??(a.function={name:o.name??"",arguments:""})),(null==o?void 0:o.name)&&(a.function.name=o.name),(null==o?void 0:o.arguments)&&(a.function.arguments+=o.arguments,vn(ir(this,Vn,"f"),a)&&(a.function.parsed_arguments=Gn(a.function.arguments)))}}}return o},Symbol.asyncIterator)](){const e=[],t=[];let s=!1;return this.on("chunk",(s=>{const n=t.shift();n?n.resolve(s):e.push(s)})),this.on("end",(()=>{s=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{s=!0;for(const s of t)s.reject(e);t.length=0})),this.on("error",(e=>{s=!0;for(const s of t)s.reject(e);t.length=0})),{next:async()=>{if(!e.length)return s?{value:void 0,done:!0}:new Promise(((e,s)=>t.push({resolve:e,reject:s}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));return{value:e.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Ht(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function lr(e){return JSON.stringify(e)}class cr extends ar{static fromReadableStream(e){const t=new cr(null);return t._run((()=>t._fromReadableStream(e))),t}static runFunctions(e,t,s){const n=new cr(null),r={...s,headers:{...null==s?void 0:s.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run((()=>n._runFunctions(e,t,r))),n}static runTools(e,t,s){const n=new cr(t),r={...s,headers:{...null==s?void 0:s.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run((()=>n._runTools(e,t,r))),n}}let dr=class extends Ps{parse(e,t){return function(e){for(const t of e??[]){if("function"!==t.type)throw new bt(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(!0!==t.function.strict)throw new bt(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}(e.tools),this._client.chat.completions.create(e,{...t,headers:{...null==t?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap((t=>yn(t,e)))}runFunctions(e,t){return e.stream?cr.runFunctions(this._client,e,t):kn.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?cr.runTools(this._client,e,t):kn.runTools(this._client,e,t)}stream(e,t){return ar.createChatCompletion(this._client,e,t)}};class ur extends Ps{constructor(){super(...arguments),this.completions=new dr(this._client)}}(ur||(ur={})).Completions=dr;class hr extends Ps{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...null==t?void 0:t.headers}})}}class pr extends Ps{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...null==t?void 0:t.headers}})}}class fr extends Ps{constructor(){super(...arguments),this.sessions=new hr(this._client),this.transcriptionSessions=new pr(this._client)}}fr.Sessions=hr,fr.TranscriptionSessions=pr;var mr,gr,yr,wr,vr,xr,br,_r,Er,Cr,jr,Ar,Nr,Sr,Ir,Or,Rr,kr,Tr,Pr,$r,Mr,Lr=function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)},Dr=function(e,t,s,n,r){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?r.call(e,s):r?r.value=s:t.set(e,s),s};class Fr extends fn{constructor(){super(...arguments),mr.add(this),gr.set(this,[]),yr.set(this,{}),wr.set(this,{}),vr.set(this,void 0),xr.set(this,void 0),br.set(this,void 0),_r.set(this,void 0),Er.set(this,void 0),Cr.set(this,void 0),jr.set(this,void 0),Ar.set(this,void 0),Nr.set(this,void 0)}[(gr=new WeakMap,yr=new WeakMap,wr=new WeakMap,vr=new WeakMap,xr=new WeakMap,br=new WeakMap,_r=new WeakMap,Er=new WeakMap,Cr=new WeakMap,jr=new WeakMap,Ar=new WeakMap,Nr=new WeakMap,mr=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let s=!1;return this.on("event",(s=>{const n=t.shift();n?n.resolve(s):e.push(s)})),this.on("end",(()=>{s=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{s=!0;for(const s of t)s.reject(e);t.length=0})),this.on("error",(e=>{s=!0;for(const s of t)s.reject(e);t.length=0})),{next:async()=>{if(!e.length)return s?{value:void 0,done:!0}:new Promise(((e,s)=>t.push({resolve:e,reject:s}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));return{value:e.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new Fr;return t._run((()=>t._fromReadableStream(e))),t}async _fromReadableStream(e,t){var s;const n=null==t?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),this._connected();const r=Ht.fromReadableStream(e,this.controller);for await(const o of r)Lr(this,mr,"m",Sr).call(this,o);if(null==(s=r.controller.signal)?void 0:s.aborted)throw new Et;return this._addRun(Lr(this,mr,"m",Ir).call(this))}toReadableStream(){return new Ht(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,s,n,r){const o=new Fr;return o._run((()=>o._runToolAssistantStream(e,t,s,n,{...r,headers:{...null==r?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}}))),o}async _createToolAssistantStream(e,t,s,n,r){var o;const i=null==r?void 0:r.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",(()=>this.controller.abort())));const a={...n,stream:!0},l=await e.submitToolOutputs(t,s,a,{...r,signal:this.controller.signal});this._connected();for await(const c of l)Lr(this,mr,"m",Sr).call(this,c);if(null==(o=l.controller.signal)?void 0:o.aborted)throw new Et;return this._addRun(Lr(this,mr,"m",Ir).call(this))}static createThreadAssistantStream(e,t,s){const n=new Fr;return n._run((()=>n._threadAssistantStream(e,t,{...s,headers:{...null==s?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}}))),n}static createAssistantStream(e,t,s,n){const r=new Fr;return r._run((()=>r._runAssistantStream(e,t,s,{...n,headers:{...null==n?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}}))),r}currentEvent(){return Lr(this,jr,"f")}currentRun(){return Lr(this,Ar,"f")}currentMessageSnapshot(){return Lr(this,vr,"f")}currentRunStepSnapshot(){return Lr(this,Nr,"f")}async finalRunSteps(){return await this.done(),Object.values(Lr(this,yr,"f"))}async finalMessages(){return await this.done(),Object.values(Lr(this,wr,"f"))}async finalRun(){if(await this.done(),!Lr(this,xr,"f"))throw Error("Final run was not received.");return Lr(this,xr,"f")}async _createThreadAssistantStream(e,t,s){var n;const r=null==s?void 0:s.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort())));const o={...t,stream:!0},i=await e.createAndRun(o,{...s,signal:this.controller.signal});this._connected();for await(const a of i)Lr(this,mr,"m",Sr).call(this,a);if(null==(n=i.controller.signal)?void 0:n.aborted)throw new Et;return this._addRun(Lr(this,mr,"m",Ir).call(this))}async _createAssistantStream(e,t,s,n){var r;const o=null==n?void 0:n.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",(()=>this.controller.abort())));const i={...s,stream:!0},a=await e.create(t,i,{...n,signal:this.controller.signal});this._connected();for await(const l of a)Lr(this,mr,"m",Sr).call(this,l);if(null==(r=a.controller.signal)?void 0:r.aborted)throw new Et;return this._addRun(Lr(this,mr,"m",Ir).call(this))}static accumulateDelta(e,t){for(const[s,n]of Object.entries(t)){if(!e.hasOwnProperty(s)){e[s]=n;continue}let t=e[s];if(null!=t)if("index"!==s&&"type"!==s){if("string"==typeof t&&"string"==typeof n)t+=n;else if("number"==typeof t&&"number"==typeof n)t+=n;else{if(!Rs(t)||!Rs(n)){if(Array.isArray(t)&&Array.isArray(n)){if(t.every((e=>"string"==typeof e||"number"==typeof e))){t.push(...n);continue}for(const e of n){if(!Rs(e))throw new Error(`Expected array delta entry to be an object but got: ${e}`);const s=e.index;if(null==s)throw console.error(e),new Error("Expected array delta entry to have an `index` property");if("number"!=typeof s)throw new Error(`Expected array delta entry \`index\` property to be a number but got ${s}`);const n=t[s];null==n?t.push(e):t[s]=this.accumulateDelta(n,e)}continue}throw Error(`Unhandled record type: ${s}, deltaValue: ${n}, accValue: ${t}`)}t=this.accumulateDelta(t,n)}e[s]=t}else e[s]=n;else e[s]=n}return e}_addRun(e){return e}async _threadAssistantStream(e,t,s){return await this._createThreadAssistantStream(t,e,s)}async _runAssistantStream(e,t,s,n){return await this._createAssistantStream(t,e,s,n)}async _runToolAssistantStream(e,t,s,n,r){return await this._createToolAssistantStream(s,e,t,n,r)}}Sr=function(e){if(!this.ended)switch(Dr(this,jr,e,"f"),Lr(this,mr,"m",kr).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":Lr(this,mr,"m",Mr).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Lr(this,mr,"m",Rr).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":Lr(this,mr,"m",Or).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Ir=function(){if(this.ended)throw new bt("stream has ended, this shouldn't happen");if(!Lr(this,xr,"f"))throw Error("Final run has not been received");return Lr(this,xr,"f")},Or=function(e){const[t,s]=Lr(this,mr,"m",Pr).call(this,e,Lr(this,vr,"f"));Dr(this,vr,t,"f"),Lr(this,wr,"f")[t.id]=t;for(const n of s){const e=t.content[n.index];"text"==(null==e?void 0:e.type)&&this._emit("textCreated",e.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const s of e.data.delta.content){if("text"==s.type&&s.text){let e=s.text,n=t.content[s.index];if(!n||"text"!=n.type)throw Error("The snapshot associated with this text delta is not text or missing");this._emit("textDelta",e,n.text)}if(s.index!=Lr(this,br,"f")){if(Lr(this,_r,"f"))switch(Lr(this,_r,"f").type){case"text":this._emit("textDone",Lr(this,_r,"f").text,Lr(this,vr,"f"));break;case"image_file":this._emit("imageFileDone",Lr(this,_r,"f").image_file,Lr(this,vr,"f"))}Dr(this,br,s.index,"f")}Dr(this,_r,t.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==Lr(this,br,"f")){const t=e.data.content[Lr(this,br,"f")];if(t)switch(t.type){case"image_file":this._emit("imageFileDone",t.image_file,Lr(this,vr,"f"));break;case"text":this._emit("textDone",t.text,Lr(this,vr,"f"))}}Lr(this,vr,"f")&&this._emit("messageDone",e.data),Dr(this,vr,void 0,"f")}},Rr=function(e){const t=Lr(this,mr,"m",Tr).call(this,e);switch(Dr(this,Nr,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const s=e.data.delta;if(s.step_details&&"tool_calls"==s.step_details.type&&s.step_details.tool_calls&&"tool_calls"==t.step_details.type)for(const e of s.step_details.tool_calls)e.index==Lr(this,Er,"f")?this._emit("toolCallDelta",e,t.step_details.tool_calls[e.index]):(Lr(this,Cr,"f")&&this._emit("toolCallDone",Lr(this,Cr,"f")),Dr(this,Er,e.index,"f"),Dr(this,Cr,t.step_details.tool_calls[e.index],"f"),Lr(this,Cr,"f")&&this._emit("toolCallCreated",Lr(this,Cr,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Dr(this,Nr,void 0,"f");"tool_calls"==e.data.step_details.type&&Lr(this,Cr,"f")&&(this._emit("toolCallDone",Lr(this,Cr,"f")),Dr(this,Cr,void 0,"f")),this._emit("runStepDone",e.data,t)}},kr=function(e){Lr(this,gr,"f").push(e),this._emit("event",e)},Tr=function(e){switch(e.event){case"thread.run.step.created":return Lr(this,yr,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=Lr(this,yr,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let s=e.data;if(s.delta){const n=Fr.accumulateDelta(t,s.delta);Lr(this,yr,"f")[e.data.id]=n}return Lr(this,yr,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":Lr(this,yr,"f")[e.data.id]=e.data}if(Lr(this,yr,"f")[e.data.id])return Lr(this,yr,"f")[e.data.id];throw new Error("No snapshot available")},Pr=function(e,t){let s=[];switch(e.event){case"thread.message.created":return[e.data,s];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let n=e.data;if(n.delta.content)for(const e of n.delta.content)if(e.index in t.content){let s=t.content[e.index];t.content[e.index]=Lr(this,mr,"m",$r).call(this,e,s)}else t.content[e.index]=e,s.push(e);return[t,s];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,s];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},$r=function(e,t){return Fr.accumulateDelta(t,e)},Mr=function(e){switch(Dr(this,Ar,e.data,"f"),e.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":Dr(this,xr,e.data,"f"),Lr(this,Cr,"f")&&(this._emit("toolCallDone",Lr(this,Cr,"f")),Dr(this,Cr,void 0,"f"))}};class qr extends Ps{create(e,t,s){return this._client.post(`/threads/${e}/messages`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...null==s?void 0:s.headers}})}retrieve(e,t,s){return this._client.get(`/threads/${e}/messages/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...null==s?void 0:s.headers}})}update(e,t,s,n){return this._client.post(`/threads/${e}/messages/${t}`,{body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}list(e,t={},s){return us(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,Ur,{query:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...null==s?void 0:s.headers}})}del(e,t,s){return this._client.delete(`/threads/${e}/messages/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...null==s?void 0:s.headers}})}}class Ur extends Ts{}qr.MessagesPage=Ur;class Br extends Ps{retrieve(e,t,s,n={},r){return us(n)?this.retrieve(e,t,s,{},n):this._client.get(`/threads/${e}/runs/${t}/steps/${s}`,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...null==r?void 0:r.headers}})}list(e,t,s={},n){return us(s)?this.list(e,t,{},s):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,Hr,{query:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}}class Hr extends Ts{}Br.RunStepsPage=Hr;class Wr extends Ps{constructor(){super(...arguments),this.steps=new Br(this._client)}create(e,t,s){const{include:n,...r}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:n},body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...null==s?void 0:s.headers},stream:t.stream??!1})}retrieve(e,t,s){return this._client.get(`/threads/${e}/runs/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...null==s?void 0:s.headers}})}update(e,t,s,n){return this._client.post(`/threads/${e}/runs/${t}`,{body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}list(e,t={},s){return us(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,zr,{query:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...null==s?void 0:s.headers}})}cancel(e,t,s){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...null==s?void 0:s.headers}})}async createAndPoll(e,t,s){const n=await this.create(e,t,s);return await this.poll(e,n.id,s)}createAndStream(e,t,s){return Fr.createAssistantStream(e,this._client.beta.threads.runs,t,s)}async poll(e,t,s){const n={...null==s?void 0:s.headers,"X-Stainless-Poll-Helper":"true"};for((null==s?void 0:s.pollIntervalMs)&&(n["X-Stainless-Custom-Poll-Interval"]=s.pollIntervalMs.toString());;){const{data:r,response:o}=await this.retrieve(e,t,{...s,headers:{...null==s?void 0:s.headers,...n}}).withResponse();switch(r.status){case"queued":case"in_progress":case"cancelling":let e=5e3;if(null==s?void 0:s.pollIntervalMs)e=s.pollIntervalMs;else{const t=o.headers.get("openai-poll-after-ms");if(t){const s=parseInt(t);isNaN(s)||(e=s)}}await xs(e);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return r}}}stream(e,t,s){return Fr.createAssistantStream(e,this._client.beta.threads.runs,t,s)}submitToolOutputs(e,t,s,n){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers},stream:s.stream??!1})}async submitToolOutputsAndPoll(e,t,s,n){const r=await this.submitToolOutputs(e,t,s,n);return await this.poll(e,r.id,n)}submitToolOutputsStream(e,t,s,n){return Fr.createToolAssistantStream(e,t,this._client.beta.threads.runs,s,n)}}class zr extends Ts{}Wr.RunsPage=zr,Wr.Steps=Br,Wr.RunStepsPage=Hr;class Gr extends Ps{constructor(){super(...arguments),this.runs=new Wr(this._client),this.messages=new qr(this._client)}create(e={},t){return us(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...null==t?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...null==t?void 0:t.headers}})}update(e,t,s){return this._client.post(`/threads/${e}`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...null==s?void 0:s.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...null==t?void 0:t.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...null==t?void 0:t.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const s=await this.createAndRun(e,t);return await this.runs.poll(s.thread_id,s.id,t)}createAndRunStream(e,t){return Fr.createThreadAssistantStream(e,this._client.beta.threads,t)}}Gr.Runs=Wr,Gr.RunsPage=zr,Gr.Messages=qr,Gr.MessagesPage=Ur;class Kr extends Ps{constructor(){super(...arguments),this.realtime=new fr(this._client),this.chat=new ur(this._client),this.assistants=new Gs(this._client),this.threads=new Gr(this._client)}}Kr.Realtime=fr,Kr.Assistants=Gs,Kr.AssistantsPage=Ks,Kr.Threads=Gr;class Vr extends Ps{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class Xr extends Ps{create(e,t){return this._client.post("/embeddings",{body:e,...t})}}let Jr=class extends Ps{create(e,t){return this._client.post("/files",Qt({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return us(e)?this.list({},e):this._client.getAPIList("/files",Yr,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...null==t?void 0:t.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:s=18e5}={}){const n=new Set(["processed","error","deleted"]),r=Date.now();let o=await this.retrieve(e);for(;!o.status||!n.has(o.status);)if(await xs(t),o=await this.retrieve(e),Date.now()-r>s)throw new jt({message:`Giving up on waiting for file ${e} to finish processing after ${s} milliseconds.`});return o}};class Yr extends Ts{}Jr.FileObjectsPage=Yr;class Qr extends Ps{list(e,t={},s){return us(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,Zr,{query:t,...s})}}class Zr extends Ts{}Qr.FineTuningJobCheckpointsPage=Zr;class eo extends Ps{constructor(){super(...arguments),this.checkpoints=new Qr(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return us(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",to,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},s){return us(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,so,{query:t,...s})}}class to extends Ts{}class so extends Ts{}eo.FineTuningJobsPage=to,eo.FineTuningJobEventsPage=so,eo.Checkpoints=Qr,eo.FineTuningJobCheckpointsPage=Zr;class no extends Ps{constructor(){super(...arguments),this.jobs=new eo(this._client)}}no.Jobs=eo,no.FineTuningJobsPage=to,no.FineTuningJobEventsPage=so;class ro extends Ps{createVariation(e,t){return this._client.post("/images/variations",Qt({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",Qt({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class oo extends Ps{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",io,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class io extends ks{}oo.ModelsPage=io;class ao extends Ps{create(e,t){return this._client.post("/moderations",{body:e,...t})}}function lo(e,t){return t&&function(e){var t;if(mn(null==(t=e.text)?void 0:t.format))return!0;return!1}(t)?co(e,t):{...e,output_parsed:null,output:e.output.map((e=>"function_call"===e.type?{...e,parsed_arguments:null}:"message"===e.type?{...e,content:e.content.map((e=>({...e,parsed:null})))}:e))}}function co(e,t){const s=e.output.map((e=>{if("function_call"===e.type)return{...e,parsed_arguments:ho(t,e)};if("message"===e.type){const s=e.content.map((e=>"output_text"===e.type?{...e,parsed:uo(t,e.text)}:e));return{...e,content:s}}return e})),n=Object.assign({},e,{output:s});return Object.getOwnPropertyDescriptor(e,"output_text")||po(n),Object.defineProperty(n,"output_parsed",{enumerable:!0,get(){for(const e of n.output)if("message"===e.type)for(const t of e.content)if("output_text"===t.type&&null!==t.parsed)return t.parsed;return null}}),n}function uo(e,t){var s,n,r,o;if("json_schema"!==(null==(n=null==(s=e.text)?void 0:s.format)?void 0:n.type))return null;if("$parseRaw"in(null==(r=e.text)?void 0:r.format)){return(null==(o=e.text)?void 0:o.format).$parseRaw(t)}return JSON.parse(t)}function ho(e,t){const s=(n=e.tools??[],r=t.name,n.find((e=>"function"===e.type&&e.name===r)));var n,r,o;return{...t,...t,parsed_arguments:(o=s,"auto-parseable-tool"===(null==o?void 0:o.$brand)?s.$parseRaw(t.arguments):(null==s?void 0:s.strict)?JSON.parse(t.arguments):null)}}function po(e){const t=[];for(const s of e.output)if("message"===s.type)for(const e of s.content)"output_text"===e.type&&t.push(e.text);e.output_text=t.join("")}class fo extends Ps{list(e,t={},s){return us(t)?this.list(e,{},t):this._client.getAPIList(`/responses/${e}/input_items`,No,{query:t,...s})}}var mo,go,yo,wo,vo,xo,bo,_o,Eo=function(e,t,s,n,r){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?r.call(e,s):r?r.value=s:t.set(e,s),s},Co=function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};class jo extends fn{constructor(e){super(),mo.add(this),go.set(this,void 0),yo.set(this,void 0),wo.set(this,void 0),Eo(this,go,e,"f")}static createResponse(e,t,s){const n=new jo(t);return n._run((()=>n._createResponse(e,t,{...s,headers:{...null==s?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}}))),n}async _createResponse(e,t,s){var n;const r=null==s?void 0:s.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),Co(this,mo,"m",vo).call(this);const o=await e.responses.create({...t,stream:!0},{...s,signal:this.controller.signal});this._connected();for await(const i of o)Co(this,mo,"m",xo).call(this,i);if(null==(n=o.controller.signal)?void 0:n.aborted)throw new Et;return Co(this,mo,"m",bo).call(this)}[(go=new WeakMap,yo=new WeakMap,wo=new WeakMap,mo=new WeakSet,vo=function(){this.ended||Eo(this,yo,void 0,"f")},xo=function(e){if(this.ended)return;const t=Co(this,mo,"m",_o).call(this,e);switch(this._emit("event",e),e.type){case"response.output_text.delta":{const s=t.output[e.output_index];if(!s)throw new bt(`missing output at index ${e.output_index}`);if("message"===s.type){const t=s.content[e.content_index];if(!t)throw new bt(`missing content at index ${e.content_index}`);if("output_text"!==t.type)throw new bt(`expected content to be 'output_text', got ${t.type}`);this._emit("response.output_text.delta",{...e,snapshot:t.text})}break}case"response.function_call_arguments.delta":{const s=t.output[e.output_index];if(!s)throw new bt(`missing output at index ${e.output_index}`);"function_call"===s.type&&this._emit("response.function_call_arguments.delta",{...e,snapshot:s.arguments});break}default:this._emit(e.type,e)}},bo=function(){if(this.ended)throw new bt("stream has ended, this shouldn't happen");const e=Co(this,yo,"f");if(!e)throw new bt("request ended without sending any events");Eo(this,yo,void 0,"f");const t=function(e,t){return lo(e,t)}(e,Co(this,go,"f"));return Eo(this,wo,t,"f"),t},_o=function(e){let t=Co(this,yo,"f");if(!t){if("response.created"!==e.type)throw new bt(`When snapshot hasn't been set yet, expected 'response.created' event, got ${e.type}`);return t=Eo(this,yo,e.response,"f"),t}switch(e.type){case"response.output_item.added":t.output.push(e.item);break;case"response.content_part.added":{const s=t.output[e.output_index];if(!s)throw new bt(`missing output at index ${e.output_index}`);"message"===s.type&&s.content.push(e.part);break}case"response.output_text.delta":{const s=t.output[e.output_index];if(!s)throw new bt(`missing output at index ${e.output_index}`);if("message"===s.type){const t=s.content[e.content_index];if(!t)throw new bt(`missing content at index ${e.content_index}`);if("output_text"!==t.type)throw new bt(`expected content to be 'output_text', got ${t.type}`);t.text+=e.delta}break}case"response.function_call_arguments.delta":{const s=t.output[e.output_index];if(!s)throw new bt(`missing output at index ${e.output_index}`);"function_call"===s.type&&(s.arguments+=e.delta);break}case"response.completed":Eo(this,yo,e.response,"f")}return t},Symbol.asyncIterator)](){const e=[],t=[];let s=!1;return this.on("event",(s=>{const n=t.shift();n?n.resolve(s):e.push(s)})),this.on("end",(()=>{s=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{s=!0;for(const s of t)s.reject(e);t.length=0})),this.on("error",(e=>{s=!0;for(const s of t)s.reject(e);t.length=0})),{next:async()=>{if(!e.length)return s?{value:void 0,done:!0}:new Promise(((e,s)=>t.push({resolve:e,reject:s}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));return{value:e.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=Co(this,wo,"f");if(!e)throw new bt("stream ended without producing a ChatCompletion");return e}}class Ao extends Ps{constructor(){super(...arguments),this.inputItems=new fo(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap((e=>("object"in e&&"response"===e.object&&po(e),e)))}retrieve(e,t={},s){return us(t)?this.retrieve(e,{},t):this._client.get(`/responses/${e}`,{query:t,...s})}del(e,t){return this._client.delete(`/responses/${e}`,{...t,headers:{Accept:"*/*",...null==t?void 0:t.headers}})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap((t=>co(t,e)))}stream(e,t){return jo.createResponse(this._client,e,t)}}class No extends Ts{}Ao.InputItems=fo;class So extends Ps{create(e,t,s){return this._client.post(`/uploads/${e}/parts`,Qt({body:t,...s}))}}class Io extends Ps{constructor(){super(...arguments),this.parts=new So(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,s){return this._client.post(`/uploads/${e}/complete`,{body:t,...s})}}Io.Parts=So;class Oo extends Ps{create(e,t,s){return this._client.post(`/vector_stores/${e}/files`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...null==s?void 0:s.headers}})}retrieve(e,t,s){return this._client.get(`/vector_stores/${e}/files/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...null==s?void 0:s.headers}})}update(e,t,s,n){return this._client.post(`/vector_stores/${e}/files/${t}`,{body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}list(e,t={},s){return us(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,Ro,{query:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...null==s?void 0:s.headers}})}del(e,t,s){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...null==s?void 0:s.headers}})}async createAndPoll(e,t,s){const n=await this.create(e,t,s);return await this.poll(e,n.id,s)}async poll(e,t,s){const n={...null==s?void 0:s.headers,"X-Stainless-Poll-Helper":"true"};for((null==s?void 0:s.pollIntervalMs)&&(n["X-Stainless-Custom-Poll-Interval"]=s.pollIntervalMs.toString());;){const r=await this.retrieve(e,t,{...s,headers:n}).withResponse(),o=r.data;switch(o.status){case"in_progress":let e=5e3;if(null==s?void 0:s.pollIntervalMs)e=s.pollIntervalMs;else{const t=r.response.headers.get("openai-poll-after-ms");if(t){const s=parseInt(t);isNaN(s)||(e=s)}}await xs(e);break;case"failed":case"completed":return o}}}async upload(e,t,s){const n=await this._client.files.create({file:t,purpose:"assistants"},s);return this.create(e,{file_id:n.id},s)}async uploadAndPoll(e,t,s){const n=await this.upload(e,t,s);return await this.poll(e,n.id,s)}content(e,t,s){return this._client.getAPIList(`/vector_stores/${e}/files/${t}/content`,ko,{...s,headers:{"OpenAI-Beta":"assistants=v2",...null==s?void 0:s.headers}})}}class Ro extends Ts{}class ko extends ks{}Oo.VectorStoreFilesPage=Ro,Oo.FileContentResponsesPage=ko;class To extends Ps{create(e,t,s){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...null==s?void 0:s.headers}})}retrieve(e,t,s){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...null==s?void 0:s.headers}})}cancel(e,t,s){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...null==s?void 0:s.headers}})}async createAndPoll(e,t,s){const n=await this.create(e,t);return await this.poll(e,n.id,s)}listFiles(e,t,s={},n){return us(s)?this.listFiles(e,t,{},s):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,Ro,{query:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}async poll(e,t,s){const n={...null==s?void 0:s.headers,"X-Stainless-Poll-Helper":"true"};for((null==s?void 0:s.pollIntervalMs)&&(n["X-Stainless-Custom-Poll-Interval"]=s.pollIntervalMs.toString());;){const{data:r,response:o}=await this.retrieve(e,t,{...s,headers:n}).withResponse();switch(r.status){case"in_progress":let e=5e3;if(null==s?void 0:s.pollIntervalMs)e=s.pollIntervalMs;else{const t=o.headers.get("openai-poll-after-ms");if(t){const s=parseInt(t);isNaN(s)||(e=s)}}await xs(e);break;case"failed":case"cancelled":case"completed":return r}}}async uploadAndPoll(e,{files:t,fileIds:s=[]},n){if(null==t||0==t.length)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const r=(null==n?void 0:n.maxConcurrency)??5,o=Math.min(r,t.length),i=this._client,a=t.values(),l=[...s];const c=Array(o).fill(a).map((async function(e){for(let t of e){const e=await i.files.create({file:t,purpose:"assistants"},n);l.push(e.id)}}));return await(async e=>{const t=await Promise.allSettled(e),s=t.filter((e=>"rejected"===e.status));if(s.length){for(const e of s)console.error(e.reason);throw new Error(`${s.length} promise(s) failed - see the above errors`)}const n=[];for(const r of t)"fulfilled"===r.status&&n.push(r.value);return n})(c),await this.createAndPoll(e,{file_ids:l})}}class Po extends Ps{constructor(){super(...arguments),this.files=new Oo(this._client),this.fileBatches=new To(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...null==t?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...null==t?void 0:t.headers}})}update(e,t,s){return this._client.post(`/vector_stores/${e}`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...null==s?void 0:s.headers}})}list(e={},t){return us(e)?this.list({},e):this._client.getAPIList("/vector_stores",$o,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...null==t?void 0:t.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...null==t?void 0:t.headers}})}search(e,t,s){return this._client.getAPIList(`/vector_stores/${e}/search`,Mo,{body:t,method:"post",...s,headers:{"OpenAI-Beta":"assistants=v2",...null==s?void 0:s.headers}})}}class $o extends Ts{}class Mo extends ks{}var Lo;Po.VectorStoresPage=$o,Po.VectorStoreSearchResponsesPage=Mo,Po.Files=Oo,Po.VectorStoreFilesPage=Ro,Po.FileContentResponsesPage=ko,Po.FileBatches=To;class Do extends is{constructor({baseURL:e=Es("OPENAI_BASE_URL"),apiKey:t=Es("OPENAI_API_KEY"),organization:s=Es("OPENAI_ORG_ID")??null,project:n=Es("OPENAI_PROJECT_ID")??null,...r}={}){if(void 0===t)throw new bt("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:t,organization:s,project:n,...r,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator)throw new bt("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new Vr(this),this.chat=new Fs(this),this.embeddings=new Xr(this),this.files=new Jr(this),this.images=new ro(this),this.audio=new Hs(this),this.moderations=new ao(this),this.models=new oo(this),this.fineTuning=new no(this),this.vectorStores=new Po(this),this.beta=new Kr(this),this.batches=new Ws(this),this.uploads=new Io(this),this.responses=new Ao(this),this._options=o,this.apiKey=t,this.organization=s,this.project=n}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return lt(e,{arrayFormat:"brackets"})}}Lo=Do,Do.OpenAI=Lo,Do.DEFAULT_TIMEOUT=6e5,Do.OpenAIError=bt,Do.APIError=_t,Do.APIConnectionError=Ct,Do.APIConnectionTimeoutError=jt,Do.APIUserAbortError=Et,Do.NotFoundError=It,Do.ConflictError=Ot,Do.RateLimitError=kt,Do.BadRequestError=At,Do.AuthenticationError=Nt,Do.InternalServerError=Tt,Do.PermissionDeniedError=St,Do.UnprocessableEntityError=Rt,Do.toFile=Vt,Do.fileFromPath=yt,Do.Completions=Vr,Do.Chat=Fs,Do.ChatCompletionsPage=Ls,Do.Embeddings=Xr,Do.Files=Jr,Do.FileObjectsPage=Yr,Do.Images=ro,Do.Audio=Hs,Do.Moderations=ao,Do.Models=oo,Do.ModelsPage=io,Do.FineTuning=no,Do.VectorStores=Po,Do.VectorStoresPage=$o,Do.VectorStoreSearchResponsesPage=Mo,Do.Beta=Kr,Do.Batches=Ws,Do.BatchesPage=zs,Do.Uploads=Io,Do.Responses=Ao;const Fo=new class{constructor(e){this.apiKey=e}getGenerativeModel(e,t){if(!e.model)throw new pe("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new Ge(this.apiKey,e,t)}getGenerativeModelFromCachedContent(e,t,s){if(!e.name)throw new ge("Cached content must contain a `name` field.");if(!e.model)throw new ge("Cached content must contain a `model` field.");const n=["model","systemInstruction"];for(const o of n)if((null==t?void 0:t[o])&&e[o]&&(null==t?void 0:t[o])!==e[o]){if("model"===o){if((t.model.startsWith("models/")?t.model.replace("models/",""):t.model)===(e.model.startsWith("models/")?e.model.replace("models/",""):e.model))continue}throw new ge(`Different value for "${o}" specified in modelParams (${t[o]}) and cachedContent (${e[o]})`)}const r=Object.assign(Object.assign({},t),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new Ge(this.apiKey,r,s)}}("your_gemini_api_key_here"),qo=new Do({apiKey:"your_openai_api_key_here",dangerouslyAllowBrowser:!0}),Uo=Fo.getGenerativeModel({model:"gemini-pro"}),Bo=Fo.getGenerativeModel({model:"gemini-pro-vision"}),Ho=async e=>{try{if(e.includes("data:image")){const[t,s]=e.split(": "),n={inlineData:{data:s.split(",")[1],mimeType:"image/jpeg"}},r=await Bo.generateContent([t,n]);return(await r.response).text()}{const t=await Uo.generateContent(e);return(await t.response).text()}}catch(t){if(console.error("Error in generateAIContent:",t),t instanceof Error)throw new Error(`Failed to generate AI content: ${t.message}`);throw new Error("Failed to generate AI content. Please check your API keys and try again.")}},Wo=async e=>{var t,s;try{const n=`Create a detailed educational visualization for: ${e.includes("data:image")?e.split(": ")[0]:e}. \n    Requirements:\n    - Clear and professional design\n    - Suitable for educational purposes\n    - High visual clarity and readability\n    - Include relevant educational elements\n    - Use appropriate colors and contrast\n    Make it engaging and informative for students.`,r=await qo.images.generate({model:"dall-e-3",prompt:n,n:1,size:"1024x1024",quality:"standard",style:"natural"});if(!(null==(s=null==(t=r.data)?void 0:t[0])?void 0:s.url))throw new Error("No image URL received from OpenAI");return r.data[0].url}catch(n){if(console.error("Error in generateAIImage:",n),n instanceof Error){if(n.message.includes("API key"))throw new Error("Invalid or missing OpenAI API key. Please check your .env file.");throw new Error(`Failed to generate image: ${n.message}`)}throw new Error("Failed to generate image. Please try again.")}};function zo(){const[s,r]=n.useState(!0),[o,i]=n.useState(""),[a,l]=n.useState(""),[c,d]=n.useState(null),[u,h]=n.useState(null),[p,f]=n.useState(null),[m,g]=n.useState(!1),[y,w]=n.useState(""),[v,x]=n.useState(null),[_,C]=n.useState(!1),[A,N]=n.useState(!1),I=window.speechSynthesis,O=n.useRef(null);n.useEffect((()=>()=>{I.cancel()}),[]);const R=e=>{try{return new URL(e),!0}catch{return!1}},T=async e=>{g(!0);try{const s="https://cors-anywhere.herokuapp.com/",n=e.startsWith("http")?`${s}${e}`:e;if((e=>[".mp4",".webm",".ogg",".mov"].some((t=>e.toLowerCase().endsWith(t))))(e))return h(e),f("video"),i(e),!0;if((e=>[".jpg",".jpeg",".png",".gif",".webp",".bmp",".svg"].some((t=>e.toLowerCase().endsWith(t))))(e))try{const t=await fetch(n);if(!t.ok)throw new Error("Failed to fetch image");const s=await t.blob(),r=URL.createObjectURL(s);return h(r),f("image"),i(e),!0}catch(t){return console.error("Error fetching image:",t),h(e),f("image"),i(e),!0}return new Promise((t=>{const s=new Image;s.onload=()=>{h(e),f("image"),i(e),t(!0)},s.onerror=()=>{const s=document.createElement("video");s.onloadeddata=()=>{h(e),f("video"),i(e),t(!0)},s.onerror=()=>{t(!1)},s.src=e},s.src=e}))}catch(t){return console.error("Error processing URL:",t),!1}finally{g(!1)}};n.useEffect((()=>()=>{u&&URL.revokeObjectURL(u)}),[u]);const P=()=>{if(!A)return null;n.useEffect((()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="auto"})),[]);const t=s?u:v,r=!s||"image"===p,o=()=>{N(!1)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center overflow-y-auto p-4",onClick:e=>{e.target===e.currentTarget&&o()},children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl max-w-[90vw] max-h-[90vh] w-full",children:[e.jsx("button",{onClick:o,className:"absolute -top-12 right-0 text-white hover:text-gray-200 z-50",children:e.jsx($,{size:32})}),e.jsx("div",{className:"overflow-auto max-h-[90vh] p-4",children:r?e.jsx("img",{src:t||"",alt:"Full size preview",className:"w-full h-auto object-contain",style:{maxHeight:"calc(90vh - 2rem)"}}):e.jsx("video",{src:t||"",controls:!0,className:"w-full h-auto max-h-[80vh]",children:"Your browser does not support the video tag."})})]})})};return e.jsxs("div",{className:"min-h-screen bg-gray-50 py-12",children:[e.jsx(P,{}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx(t.h1,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"text-4xl font-bold text-gray-900 mb-4",children:"Experience the Transformation"}),e.jsx(t.p,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"text-xl text-gray-600",children:"See how AI transforms traditional content into interactive learning experiences"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Input Content"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("textarea",{value:o,onChange:e=>{const t=e.target.value;i(t),f("text"),h(null)},placeholder:"Enter your educational content here...",className:"w-full h-48 p-4 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{ref:O,type:"file",className:"hidden",onChange:e=>{var t;const s=null==(t=e.target.files)?void 0:t[0];if(!s)return;d(s);const n=URL.createObjectURL(s);if(h(n),s.type.startsWith("image/"))f("image");else if(s.type.startsWith("video/"))f("video");else{f("text");const e=new FileReader;e.onload=e=>{var t;i(null==(t=e.target)?void 0:t.result)},e.readAsText(s)}},accept:"image/*,video/*,.txt"}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault();const t=a.match(/https?:\/\/[^\s]+/);if(t){const e=t[0];if(R(e)){await T(e)||alert("Please enter a valid image or video URL")}else alert("Please enter a valid URL")}else alert("Please enter a URL starting with http:// or https://")},className:"flex-1 flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Or paste an image/video URL...",value:a,onChange:e=>{const t=e.target.value;l(t),R(t)&&T(t)},className:"flex-1 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),e.jsxs("button",{type:"submit",className:"bg-purple-600 text-white px-6 py-2 rounded-lg flex items-center gap-2 hover:bg-purple-700 transition-colors whitespace-nowrap",children:[e.jsx(b,{size:16})," Load URL"]})]}),e.jsx("button",{onClick:async()=>{if(o.trim()){g(!0);try{const[e,t]=await Promise.all([Ho(o),Wo(o)]);w(e||""),x(t||null),r(!1)}catch(e){console.error("Error generating AI content:",e),alert("Failed to generate AI content. Please try again.")}finally{g(!1)}}else alert("Please enter some text to generate AI content")},disabled:m||!o.trim(),className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white px-6 py-2 rounded-lg flex items-center gap-2 hover:from-purple-700 hover:to-indigo-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:m?e.jsxs(e.Fragment,{children:[e.jsx(E,{size:16,className:"animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{size:16}),"Generate AI"]})})]}),e.jsx("div",{className:"flex justify-start",children:e.jsxs("button",{type:"button",onClick:()=>{var e;return null==(e=O.current)?void 0:e.click()},className:"bg-purple-600 text-white px-6 py-2 rounded-lg flex items-center gap-2 hover:bg-purple-700 transition-colors whitespace-nowrap",children:[e.jsx(k,{size:16})," Upload File"]})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h2",{className:"text-2xl font-semibold",children:"Preview"})}),e.jsx("div",{className:"min-h-[24rem] rounded-lg flex flex-col items-center justify-center overflow-hidden p-4 "+(s?"bg-gray-900 text-white":"bg-gradient-to-br from-purple-600 to-indigo-700 text-white"),children:m?e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx(E,{size:24,className:"animate-spin text-white"}),e.jsx("p",{className:"text-white text-sm",children:"Generating AI content..."})]}):s?e.jsx("div",{className:"w-full h-full overflow-auto space-y-4",children:"image"===p&&u?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("img",{src:u,alt:"Content preview",className:"max-w-full h-auto rounded-lg shadow-lg cursor-pointer",onClick:()=>N(!0),onError:()=>{h(null),f(null),alert("Failed to load image. Please try again.")}}),u&&e.jsxs("button",{onClick:()=>N(!0),className:"mt-2 bg-purple-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-purple-700 transition-colors",children:[e.jsx(j,{size:16}),"Enlarge Image"]})]}):"video"===p&&u?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("video",{src:u,controls:!0,className:"max-w-full h-auto rounded-lg shadow-lg",children:"Your browser does not support the video tag."}),e.jsxs("button",{onClick:()=>N(!0),className:"mt-2 bg-purple-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-purple-700 transition-colors",children:[e.jsx(j,{size:16}),"Enlarge Video"]})]}):o?e.jsx("pre",{className:"whitespace-pre-wrap",children:o}):e.jsx("p",{className:"text-center opacity-70",children:"Enter content or upload a file to begin"})}):e.jsxs("div",{className:"w-full h-full overflow-auto space-y-4",children:[v&&e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("img",{src:v,alt:"AI-generated visualization",className:"max-w-full h-auto rounded-lg shadow-lg cursor-pointer",onClick:()=>N(!0)}),e.jsxs("button",{onClick:()=>N(!0),className:"text-sm text-white/80 hover:text-white flex items-center gap-1",children:[e.jsx(j,{size:14}),"Click to enlarge"]})]}),y&&e.jsx("pre",{className:"whitespace-pre-wrap text-white",children:y}),!y&&!v&&e.jsx("p",{className:"text-center opacity-70",children:"AI-Enhanced View"})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"How to Use the Demo"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-gray-700",children:[e.jsx("li",{children:"Enter your educational content in the input area or upload a file"}),e.jsx("li",{children:"Your content will appear in the preview section"}),e.jsx("li",{children:'Click "Generate AI Content" to create AI-enhanced version'}),e.jsx("li",{children:"The AI will generate both enhanced content and visualizations"})]})]})]})]})}function Go(){return e.jsx("div",{className:"py-24 bg-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs(t.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.6},className:"text-center mb-16",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"About EduAI"}),e.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"We're revolutionizing education through AI-powered technology, making learning more engaging, accessible, and effective for students and educators worldwide."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-12",children:[e.jsxs(t.div,{initial:{x:-50,opacity:0},animate:{x:0,opacity:1},transition:{duration:.6,delay:.2},className:"space-y-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Our Mission"}),e.jsx("p",{className:"text-gray-600",children:"To transform traditional education by leveraging artificial intelligence, making quality education accessible to everyone, everywhere. We believe in the power of technology to create immersive, personalized learning experiences that inspire and empower the next generation."})]}),e.jsxs(t.div,{initial:{x:50,opacity:0},animate:{x:0,opacity:1},transition:{duration:.6,delay:.4},className:"space-y-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Our Vision"}),e.jsx("p",{className:"text-gray-600",children:"We envision a future where every classroom is equipped with AI-powered tools that enhance teaching and learning. A world where education knows no boundaries, and where every student has access to personalized, engaging content that helps them reach their full potential."})]})]})]})})}function Ko(){const[t,s]=n.useState({name:"",email:"",organization:"",message:""}),r=e=>{s({...t,[e.target.name]:e.target.value})};return e.jsx("div",{className:"py-24 bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"max-w-2xl mx-auto text-center mb-16",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Get Started Today"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Ready to transform your educational content? Contact us for a demo or collaboration."})]}),e.jsx("div",{className:"max-w-xl mx-auto",children:e.jsxs("form",{onSubmit:e=>{e.preventDefault(),console.log("Form submitted:",t)},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("input",{type:"text",name:"name",id:"name",value:t.name,onChange:r,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",name:"email",id:"email",value:t.email,onChange:r,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"organization",className:"block text-sm font-medium text-gray-700",children:"Organization"}),e.jsx("input",{type:"text",name:"organization",id:"organization",value:t.organization,onChange:r,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700",children:"Message"}),e.jsx("textarea",{name:"message",id:"message",rows:4,value:t.message,onChange:r,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",required:!0})]}),e.jsxs("button",{type:"submit",className:"w-full flex justify-center items-center gap-2 bg-purple-600 text-white px-8 py-3 rounded-md hover:bg-purple-700 transition-colors",children:["Send Message ",e.jsx(I,{size:16})]})]})})]})})}function Vo(){return e.jsx(i,{children:e.jsxs("div",{className:"min-h-screen flex flex-col bg-white",children:[e.jsx(L,{}),e.jsx("main",{className:"flex-grow",children:e.jsxs(a,{children:[e.jsx(l,{path:"/",element:e.jsx(F,{})}),e.jsx(l,{path:"/how-it-works",element:e.jsx(U,{})}),e.jsx(l,{path:"/features",element:e.jsx(H,{})}),e.jsx(l,{path:"/live-demo",element:e.jsx(zo,{})}),e.jsx(l,{path:"/about",element:e.jsx(Go,{})}),e.jsx(l,{path:"/contact",element:e.jsx(Ko,{})})]})}),e.jsx(D,{})]})})}u.createRoot(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsx(Vo,{})}));
